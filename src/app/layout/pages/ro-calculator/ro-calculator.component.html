<p-toast></p-toast>
<p-blockUI [blocked]="isInProcessingPreset"></p-blockUI>
<p-confirmDialog [position]="'top'" [style]="{ width: '25vw' }"></p-confirmDialog>

<app-item-search
  [items]="items"
  [selectedCharacter]="selectedCharacter"
  [equipableItems]="equipableItems"
  [offensiveSkills]="offensiveSkills"
  [onClassChanged]="onClassChanged$"
></app-item-search>

<p-dialog
  header=""
  position="left"
  [modal]="true"
  [(visible)]="isShowMonsterEle"
  [style]="{ width: '50vw', 'min-width': '1378px', height: '100vh', 'min-height': '500px' }"
  [draggable]="false"
  [resizable]="false"
>
  <app-elemental-table [monsterMap]="monsterDataMap" [groupMonsterList]="groupMonsterList" [allSelectedMonsterIds]="allSelectedMonsterIds"></app-elemental-table>
</p-dialog>

<div class="grid grid-nogutter" style="min-width: 1500px">
  <!-- Left Side -->
  <div class="p-fluid col-7">
    <!-- Create Update Class -->
    <div class="grid grid-nogutter">
      <div class="col-4">
        <div class="grid grid-nogutter">
          <div class="col-12">
            <div class="p-inputgroup">
              <input #presetName [autocomplete]="false" type="text" pInputText placeholder="Name" />
              <button
                type="button"
                class="p-button-success"
                pButton
                label="Save"
                [loading]="isInProcessingPreset"
                [disabled]="!presetName.value || isInProcessingPreset"
                (click)="updatePreset(presetName.value)"
              ></button>
              <button type="button" class="p-button-secondary" pButton icon="pi pi-cog" [disabled]="isInProcessingPreset" (click)="openPresetManagement()"></button>
            </div>
          </div>
          <div class="col-12">
            <div class="p-inputgroup dropdown-joblist">
              <p-dropdown
                [autoDisplayFirst]="false"
                [options]="preSets"
                [filter]="true"
                filterBy="label"
                placeholder="Presets"
                scrollHeight="350px"
                [(ngModel)]="selectedPreset"
              >
                <ng-template let-job pTemplate="selectedItem">
                  <div class="flex gap-2 py-0 align-items-center" *ngIf="model.class">
                    <img src="assets/demo/images/jobs/icon_jobs_{{ job.icon }}.png" alt="" class="job_img" />
                    <div class="text_ellips">{{ job.label }}</div>
                  </div>
                </ng-template>
                <ng-template let-job pTemplate="item">
                  <div class="flex gap-2 py-0">
                    <img src="assets/demo/images/jobs/icon_jobs_{{ job.icon }}.png" alt="" class="job_img" />
                    <div class="text_ellips">{{ job.label }}</div>
                  </div>
                </ng-template>
              </p-dropdown>
              <p-splitButton
                styleClass="p-button-help"
                icon="pi pi-download"
                label="Load"
                (onClick)="loadPreset()"
                [disabled]="!selectedPreset || isInProcessingPreset"
                [model]="loadBtnItems"
              ></p-splitButton>
            </div>
          </div>

          <div class="col-12">
            <div class="p-inputgroup dropdown-joblist">
              <span class="p-inputgroup-addon" style="width: 80px">Class</span>
              <p-dropdown
                inputId="character"
                [autoDisplayFirst]="false"
                [resetFilterOnHide]="true"
                [options]="characterList"
                [filter]="true"
                filterBy="label"
                [(ngModel)]="model.class"
                placeholder="Class"
                scrollHeight="350px"
                [disabled]="isInProcessingPreset"
                (onChange)="onClassChange()"
              >
                <ng-template let-job pTemplate="selectedItem">
                  <div class="flex gap-2 py-0 align-items-center" *ngIf="model.class">
                    <img src="assets/demo/images/jobs/icon_jobs_{{ job.icon }}.png" alt="" class="job_img" />
                    <div class="text_ellips">{{ job.label }}</div>
                  </div>
                </ng-template>
                <ng-template let-job pTemplate="item">
                  <div class="flex gap-2 py-0">
                    <img src="assets/demo/images/jobs/icon_jobs_{{ job.icon }}.png" alt="" class="job_img" />
                    <div class="text_ellips">{{ job.label }}</div>
                  </div>
                </ng-template>
              </p-dropdown>
            </div>
          </div>
          <div class="col">
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon" style="width: 80px">Level</span>
              <p-dropdown
                inputId="level"
                [autoDisplayFirst]="false"
                [options]="levelList"
                [filter]="true"
                filterBy="label"
                scrollHeight="350px"
                [resetFilterOnHide]="true"
                [(ngModel)]="model.level"
                (onChange)="onBaseStatusChange()"
              ></p-dropdown>
            </div>
          </div>
          <div class="col-fixed">
            <button
              type="button"
              class="p-button-warning"
              pButton
              label="Up Class"
              [disabled]="!canPromote || isInProcessingPreset"
              (click)="onJobPromotionClick()"
            ></button>
          </div>
          <div class="col-12">
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon" style="width: 80px">Job</span>
              <p-dropdown
                inputId="jobLevel"
                [autoDisplayFirst]="false"
                [options]="jobList"
                [filter]="true"
                filterBy="label"
                scrollHeight="350px"
                [resetFilterOnHide]="true"
                [(ngModel)]="model.jobLevel"
                (onChange)="onJobLevelChange()"
              ></p-dropdown>
            </div>
          </div>
          <div class="col-12">
            <span class="p-inputgroup-addon"
              >Status:
              <span [className]="availablePoints < 0 ? 'ml-2 summary_monster_value px-1 font-semibold' : 'ml-2'">
                {{ availablePoints }}
                <span [hidden]="!appropriateLevel">(Lv {{ appropriateLevel > 200 ? 'x' : appropriateLevel }})</span>
              </span>

              <span [hidden]="!isAllowTraitStat"
                >, Trait:
                <span [className]="availableTraitPoints < 0 ? ' summary_monster_value px-1 font-semibold' : ''">
                  {{ availableTraitPoints }}
                  <span [hidden]="!appropriateLevelForTrait">(Lv {{ appropriateLevelForTrait > 300 ? 'x' : appropriateLevelForTrait }})</span>
                </span>
              </span>
            </span>
          </div>
        </div>
      </div>

      <!-- Status -->
      <div class="col-8">
        <div class="grid grid-nogutter">
          <div class="col-5">
            <div class="grid grid-nogutter">
              <!-- STR -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Str"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.str"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobStr || 0) + (totalSummary?.str || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Pow"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.pow"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobPow || 0) + (totalSummary?.pow || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>

              <!-- AGI -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Agi"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.agi"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobAgi || 0) + (totalSummary?.agi || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Sta"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.sta"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobSta || 0) + (totalSummary?.sta || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>

              <!-- VIT -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Vit"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.vit"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobVit || 0) + (totalSummary?.vit || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Wis"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.wis"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobWis || 0) + (totalSummary?.wis || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>

              <!-- INT -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Int"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.int"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobInt || 0) + (totalSummary?.int || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Spl"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.spl"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobSpl || 0) + (totalSummary?.spl || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>

              <!-- DEX -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Dex"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.dex"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobDex || 0) + (totalSummary?.dex || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Con"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.con"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobCon || 0) + (totalSummary?.con || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>

              <!-- LUK -->
              <div class="col-12 grid grid-nogutter">
                <div class="col-6">
                  <app-status-input
                    label="Luk"
                    [dropdownList]="mainStatusList"
                    [(value)]="model.luk"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobLuk || 0) + (totalSummary?.luk || 0)"
                  ></app-status-input>
                </div>
                <div class="col-6">
                  <app-status-input
                    label="Crt"
                    [disabled]="!isAllowTraitStat"
                    [dropdownList]="traitStatusList"
                    [(value)]="model.crt"
                    (valueChange)="onBaseStatusChange()"
                    [extraValue]="(model.jobCrt || 0) + (totalSummary?.crt || 0)"
                    badgeSeverity="danger"
                  ></app-status-input>
                </div>
              </div>
            </div>
          </div>

          <!-- Summary -->
          <div class="col-7">
            <div class="grid grid-nogutter" style="position: relative">
              <div class="loading_block" *ngIf="isCalculating">
                <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
              </div>
              <div class="col-6">
                <div class="grid grid-nogutter">
                  <div class="col-12">
                    Alt+Q Atk:
                    <span class="font-semibold px-1 summary_stat_atk">
                      {{ totalSummary?.calc?.totalStatusAtk || 0 }} +
                      {{
                        totalSummary?.weapon?.baseWeaponAtk +
                          totalSummary?.weapon?.refineBonus +
                          totalSummary?.calc?.totalMasteryAtk +
                          totalSummary?.calc?.totalEquipAtk || 0
                      }}
                    </span>
                  </div>
                  <div [hidden]="env.production" class="col-12">
                    Equip Atk:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.atk || 0 }} + {{ totalSummary?.atkPercent || 0 }} %</span>
                  </div>
                  <div class="col-6">
                    P.Atk:
                    <span class="font-semibold px-1 summary_stat_atk2">{{ totalSummary?.dmg?.pAtk || 0 }}</span>
                  </div>
                  <div class="col-6">
                    C.Rate:
                    <span class="font-semibold px-1 summary_stat_atk2">{{ totalSummary?.dmg?.cRate || 0 }}</span>
                  </div>
                  <div class="col-12">
                    ASPD:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalAspd || 0 }}</span>
                    <span class="font-semibold px-1 summary_highlight">( {{ totalSummary?.calc?.hitPerSecs || 0 }} Hits/s )</span>
                  </div>
                  <div class="col-12">
                    Hit:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalHit || 0 }}</span>
                    Perfect:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalPerfectHit || 0 }} %</span>
                  </div>
                  <div class="col-12">
                    CriRate:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalCri || 0 }} %</span>
                    Dmg: <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.criDmg || 0 }} %</span>
                  </div>
                  <div class="col-12">
                    Melee:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.melee || 0 }} %</span> Range:
                    <Span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.range || 0 }} %</Span>
                  </div>
                  <div class="col-12">
                    Def:
                    <span class="font-semibold px-1 summary_stat_def">{{ totalSummary?.calc?.softDef || 0 }} + {{ totalSummary?.calc?.def || 0 }}</span>
                    Res:
                    <span class="font-semibold px-1 summary_stat_def2">{{ totalSummary?.calc?.res || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Mdef:
                    <span class="font-semibold px-1 summary_stat_def">{{ totalSummary?.calc?.softMdef || 0 }} + {{ totalSummary?.calc?.mdef || 0 }}</span>
                    MRes:
                    <span class="font-semibold px-1 summary_stat_def2">{{ totalSummary?.calc?.mres || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Flee:
                    <span class="font-semibold px-1 summary_stat_def">{{ totalSummary?.calc?.totalFlee || 0 }} + {{ totalSummary?.calc?.totalPerfectDodge || 0 }}</span>
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="grid grid-nogutter mx-1">
                  <div class="col-12">
                    Alt+Q Matk:
                    <span class="font-semibold px-1 summary_stat_matk"
                      >{{ totalSummary?.calc?.totalStatusMatk || 0 }} +
                      {{
                        totalSummary?.weapon?.baseWeaponMatk +
                          (totalSummary?.weapon?.refineBonus || 0) +
                          (totalSummary?.calc?.leftWeaponRefineBonus || 0) +
                          (totalSummary?.matk || 0)
                      }}</span
                    >
                  </div>
                  <div [hidden]="env.production" class="col-12">
                    Equip Matk:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.matk || 0 }} + {{ totalSummary?.matkPercent || 0 }} %</span>
                  </div>
                  <div class="col-12">
                    Matk
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.matkPercent || 0 }} %</span>
                    S.Matk:
                    <span class="font-semibold px-1 summary_stat_matk2">{{ totalSummary?.dmg?.sMatk || 0 }}</span>
                  </div>
                  <div class="col-12">
                    After Cast Delay:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.acd || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Fixed Cast Time:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.fct || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Variable Cast Time:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.vct || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Dex2 Int1:
                    <span class="font-semibold px-1 summary_stat_yellow">{{ totalSummary?.calc?.dex2int1 || 0 }}</span>
                    <span [hidden]="totalSummary?.calc?.to530 <= 0">{{ '( อีก ' + totalSummary?.calc?.to530 + ' )' }}</span>
                  </div>
                  <div class="col-12 px-1 border_default hp-sp-section" [hidden]="hideHpSp[selectedCharacter?.className]">
                    <div class="grid grid-nogutter">
                      <div class="col-12 flex gap-1">
                        HP:
                        <span class="font-semibold px-1 summary_stat_yellow">{{ totalSummary?.calc?.maxHp || 0 | number }}</span>
                        <!-- <p-cascadeSelect
                          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.X_HP]"
                          [options]="baseHpOptions"
                          optionValue="value"
                          optionGroupLabel="label"
                          optionLabel="label"
                          [optionGroupChildren]="['children']"
                          placeholder="+BaseHP"
                          [showClear]="true"
                          (onChange)="onOptionChange()"
                          (onClear)="onOptionChange()"
                        ></p-cascadeSelect> -->
                      </div>
                      <div class="col-12 flex gap-1">
                        SP:
                        <span class="font-semibold px-1 summary_stat_yellow">{{ totalSummary?.calc?.maxSp || 0 | number }}</span>
                        <!-- <p-cascadeSelect
                          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.X_SP]"
                          [options]="baseSpOptions"
                          optionValue="value"
                          optionGroupLabel="label"
                          optionLabel="label"
                          [optionGroupChildren]="['children']"
                          placeholder="+BaseSP"
                          [showClear]="true"
                          (onChange)="onOptionChange()"
                          (onClear)="onOptionChange()"
                        ></p-cascadeSelect> -->
                      </div>
                      <!-- <div [hidden]="model?.level < 176" class="summary_monster_value px-1" style="color: var(--red-500)">*** Lv > 175 ไม่ตรง</div> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12 item_label_compare">
                <p-multiSelect
                  [options]="compareItemList"
                  [(ngModel)]="compareItemNames"
                  [showClear]="true"
                  [showHeader]="false"
                  [showToggleAll]="false"
                  scrollHeight="400px"
                  selectedItemsLabel="{0} slot selected"
                  placeholder="Enable item slot to compare"
                  [maxSelectedLabels]="6"
                  (onChange)="onListItemComparingChange()"
                  (onClear)="onListItemComparingChange(true)"
                ></p-multiSelect>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Weapon + Ammo -->
    <div class="grid grid-nogutter item_label_weapon_main">
      <div class="col-12">
        <app-equipment
          [itemType]="'weapon'"
          [placeholder]="'Weapon'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="weaponList"
          [refineList]="refineList"
          [cardList]="weaponCardList"
          [optionList]="optionList"
          [(itemId)]="model.weapon"
          [(itemRefine)]="model.weaponRefine"
          [(card1Id)]="model.weaponCard1"
          [(card2Id)]="model.weaponCard2"
          [(card3Id)]="model.weaponCard3"
          [(card4Id)]="model.weaponCard4"
          [(itemGrade)]="model.weaponGrade"
          [(enchant1Id)]="model.weaponEnchant0"
          [(enchant2Id)]="model.weaponEnchant1"
          [(enchant3Id)]="model.weaponEnchant2"
          [(enchant4Id)]="model.weaponEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.W_Left_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.W_Left_2]"
          [(option3Value)]="model.rawOptionTxts[itemOptionNumber.W_Left_3]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        >
          <div class="col-6 item_label_element_converter" style="min-width: 100px">
            <p-dropdown
              [options]="propertyAtkList"
              [(ngModel)]="model.propertyAtk"
              [disabled]="!model.weapon"
              [showClear]="true"
              placeholder="เคลือบ"
              scrollHeight="300px"
              (onChange)="onPropertyAtkChange()"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1" *ngIf="model.propertyAtk">
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.img }}.png" alt="" class="item_img" />
                    <div class="{{ 'property_' + item.element }}">{{ item.label }}</div>
                  </div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.img }}.png" alt="" class="item_img" />
                    <div class="{{ 'property_' + item.element }}">{{ item.label }}</div>
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-{{ isWeaponCanGrade ? 6 : 10 }}" [hidden]="hiddenMap.ammu">
            <p-dropdown
              inputId="ammo"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="ammoList"
              [showClear]="true"
              [filter]="true"
              filterBy="label"
              scrollHeight="350px"
              [(ngModel)]="model.ammo"
              (onChange)="onSelectItem('ammo', $event.value)"
              placeholder="Ammo"
              [disabled]="!model.weapon"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.ammo">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div class="{{ 'property_' + item.element }}">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div class="{{ 'property_' + item.element }}">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_leftWeapon_main">
      <div class="col-12" [hidden]="!model.weapon || !showLeftWeapon">
        <app-equipment
          [itemType]="'leftWeapon'"
          [placeholder]="'leftWeapon'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="leftWeaponList"
          [refineList]="refineList"
          [cardList]="weaponCardList"
          [optionList]="optionList"
          [(itemId)]="model.leftWeapon"
          [(itemRefine)]="model.leftWeaponRefine"
          [(card1Id)]="model.leftWeaponCard1"
          [(card2Id)]="model.leftWeaponCard2"
          [(card3Id)]="model.leftWeaponCard3"
          [(card4Id)]="model.leftWeaponCard4"
          [(itemGrade)]="model.leftWeaponGrade"
          [(enchant1Id)]="model.leftWeaponEnchant0"
          [(enchant2Id)]="model.leftWeaponEnchant1"
          [(enchant3Id)]="model.leftWeaponEnchant2"
          [(enchant4Id)]="model.leftWeaponEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.W_Right_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.W_Right_2]"
          [(option3Value)]="model.rawOptionTxts[itemOptionNumber.W_Right_3]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.weapon">
      <div class="col-12">
        <app-equipment
          [itemType]="'weapon'"
          [placeholder]="'Weapon'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="weaponList"
          [refineList]="refineList"
          [cardList]="weaponCardList"
          [optionList]="optionList"
          [(itemId)]="model2.weapon"
          [(itemRefine)]="model2.weaponRefine"
          [(card1Id)]="model2.weaponCard1"
          [(card2Id)]="model2.weaponCard2"
          [(card3Id)]="model2.weaponCard3"
          [(card4Id)]="model2.weaponCard4"
          [(itemGrade)]="model2.weaponGrade"
          [(enchant1Id)]="model2.weaponEnchant0"
          [(enchant2Id)]="model2.weaponEnchant1"
          [(enchant3Id)]="model2.weaponEnchant2"
          [(enchant4Id)]="model2.weaponEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_2]"
          [(option3Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_3]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Shield -->
    <div class="grid grid-nogutter item_label_shield_main">
      <div class="col-12" [hidden]="!model.weapon || hiddenMap.shield || !!model.leftWeapon">
        <app-equipment
          [itemType]="'shield'"
          [placeholder]="'Shield'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="shieldList"
          [refineList]="refineList"
          [cardList]="shieldCardList"
          [optionList]="optionList"
          [(itemId)]="model.shield"
          [(itemRefine)]="model.shieldRefine"
          [(card1Id)]="model.shieldCard"
          [(itemGrade)]="model.shieldGrade"
          [(enchant2Id)]="model.shieldEnchant1"
          [(enchant3Id)]="model.shieldEnchant2"
          [(enchant4Id)]="model.shieldEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.Shield_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.Shield_2]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Head Upper -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-12">
        <app-equipment
          [itemType]="'headUpper'"
          [placeholder]="'Upper'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headUpperList"
          [refineList]="refineList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model.headUpper"
          [(itemRefine)]="model.headUpperRefine"
          [(card1Id)]="model.headUpperCard"
          [(itemGrade)]="model.headUpperGrade"
          [(enchant2Id)]="model.headUpperEnchant1"
          [(enchant3Id)]="model.headUpperEnchant2"
          [(enchant4Id)]="model.headUpperEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.H_Upper_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.H_Upper_2]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headUpper">
      <div class="col-12">
        <app-equipment
          [itemType]="'headUpper'"
          [placeholder]="'Upper'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headUpperList"
          [refineList]="refineList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model2.headUpper"
          [(itemRefine)]="model2.headUpperRefine"
          [(card1Id)]="model2.headUpperCard"
          [(itemGrade)]="model2.headUpperGrade"
          [(enchant2Id)]="model2.headUpperEnchant1"
          [(enchant3Id)]="model2.headUpperEnchant2"
          [(enchant4Id)]="model2.headUpperEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.H_Upper_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.H_Upper_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Head Middle -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-12">
        <app-equipment
          [itemType]="'headMiddle'"
          [placeholder]="'Middle'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headMiddleList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model.headMiddle"
          [(card1Id)]="model.headMiddleCard"
          [(itemGrade)]="model.headMiddleGrade"
          [(enchant2Id)]="model.headMiddleEnchant1"
          [(enchant3Id)]="model.headMiddleEnchant2"
          [(enchant4Id)]="model.headMiddleEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.H_Mid_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.H_Mid_2]"
          [(option3Value)]="model.rawOptionTxts[itemOptionNumber.H_Mid_3]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headMiddle">
      <div class="col-12">
        <app-equipment
          [itemType]="'headMiddle'"
          [placeholder]="'Middle'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headMiddleList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model2.headMiddle"
          [(card1Id)]="model2.headMiddleCard"
          [(itemGrade)]="model2.headMiddleGrade"
          [(enchant2Id)]="model2.headMiddleEnchant1"
          [(enchant3Id)]="model2.headMiddleEnchant2"
          [(enchant4Id)]="model2.headMiddleEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.H_Mid_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.H_Mid_2]"
          [(option3Value)]="model2.rawOptionTxts[itemOptionNumber.H_Mid_3]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Head Lower -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-12">
        <app-equipment
          [itemType]="'headLower'"
          [placeholder]="'Lower'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headLowerList"
          [cardList]="[]"
          [(itemId)]="model.headLower"
          [(itemGrade)]="model.headLowerGrade"
          [(enchant2Id)]="model.headLowerEnchant1"
          [(enchant3Id)]="model.headLowerEnchant2"
          [(enchant4Id)]="model.headLowerEnchant3"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headLower">
      <div class="col-12">
        <app-equipment
          [itemType]="'headLower'"
          [placeholder]="'Lower'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headLowerList"
          [cardList]="[]"
          [(itemId)]="model2.headLower"
          [(itemGrade)]="model2.headLowerGrade"
          [(enchant2Id)]="model2.headLowerEnchant1"
          [(enchant3Id)]="model2.headLowerEnchant2"
          [(enchant4Id)]="model2.headLowerEnchant3"
          (selectItemChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Armor -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-12">
        <app-equipment
          [itemType]="'armor'"
          [placeholder]="'Armor'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="armorList"
          [refineList]="refineList"
          [cardList]="armorCardList"
          [optionList]="optionList"
          [(itemId)]="model.armor"
          [(itemRefine)]="model.armorRefine"
          [(card1Id)]="model.armorCard"
          [(itemGrade)]="model.armorGrade"
          [(enchant2Id)]="model.armorEnchant1"
          [(enchant3Id)]="model.armorEnchant2"
          [(enchant4Id)]="model.armorEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.Armor_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.Armor_2]"
          [(option3Value)]="model.rawOptionTxts[itemOptionNumber.Armor_3]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.armor">
      <div class="col-12">
        <app-equipment
          [itemType]="'armor'"
          [placeholder]="'Armor'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="armorList"
          [refineList]="refineList"
          [cardList]="armorCardList"
          [optionList]="optionList"
          [(itemId)]="model2.armor"
          [(itemRefine)]="model2.armorRefine"
          [(itemGrade)]="model2.armorGrade"
          [(card1Id)]="model2.armorCard"
          [(enchant2Id)]="model2.armorEnchant1"
          [(enchant3Id)]="model2.armorEnchant2"
          [(enchant4Id)]="model2.armorEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.Armor_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.Armor_2]"
          [(option3Value)]="model2.rawOptionTxts[itemOptionNumber.Armor_3]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Garment -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-12">
        <app-equipment
          [itemType]="'garment'"
          [placeholder]="'Garment'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="garmentList"
          [refineList]="refineList"
          [cardList]="garmentCardList"
          [optionList]="optionList"
          [(itemId)]="model.garment"
          [(itemRefine)]="model.garmentRefine"
          [(card1Id)]="model.garmentCard"
          [(itemGrade)]="model.garmentGrade"
          [(enchant2Id)]="model.garmentEnchant1"
          [(enchant3Id)]="model.garmentEnchant2"
          [(enchant4Id)]="model.garmentEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.Garment_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.Garment_2]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.garment">
      <div class="col-12">
        <app-equipment
          [itemType]="'garment'"
          [placeholder]="'Garment'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="garmentList"
          [refineList]="refineList"
          [cardList]="garmentCardList"
          [optionList]="optionList"
          [(itemId)]="model2.garment"
          [(itemRefine)]="model2.garmentRefine"
          [(card1Id)]="model2.garmentCard"
          [(itemGrade)]="model2.garmentGrade"
          [(enchant2Id)]="model2.garmentEnchant1"
          [(enchant3Id)]="model2.garmentEnchant2"
          [(enchant4Id)]="model2.garmentEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.Garment_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.Garment_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Boot -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-12">
        <app-equipment
          [itemType]="'boot'"
          [placeholder]="'Boot'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="bootList"
          [refineList]="refineList"
          [cardList]="bootCardList"
          [optionList]="optionList"
          [(itemId)]="model.boot"
          [(itemRefine)]="model.bootRefine"
          [(card1Id)]="model.bootCard"
          [(itemGrade)]="model.bootGrade"
          [(enchant2Id)]="model.bootEnchant1"
          [(enchant3Id)]="model.bootEnchant2"
          [(enchant4Id)]="model.bootEnchant3"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.boot">
      <div class="col-12">
        <app-equipment
          [itemType]="'Boot'"
          [placeholder]="'boot'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="bootList"
          [refineList]="refineList"
          [cardList]="bootCardList"
          [optionList]="optionList"
          [(itemId)]="model2.boot"
          [(itemRefine)]="model2.bootRefine"
          [(card1Id)]="model2.bootCard"
          [(itemGrade)]="model2.bootGrade"
          [(enchant2Id)]="model2.bootEnchant1"
          [(enchant3Id)]="model2.bootEnchant2"
          [(enchant4Id)]="model2.bootEnchant3"
          (selectItemChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Acc Right -->
    <div class="grid grid-nogutter item_label_acc">
      <div class="col-12">
        <app-equipment
          [itemType]="'accRight'"
          [placeholder]="'AccRight'"
          [overlayLabel]="'Right'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accRightList"
          [cardList]="accRightCardList"
          [optionList]="optionList"
          [(itemId)]="model.accRight"
          [(itemRefine)]="model.accRightRefine"
          [(card1Id)]="model.accRightCard"
          [(itemGrade)]="model.accRightGrade"
          [(enchant2Id)]="model.accRightEnchant1"
          [(enchant3Id)]="model.accRightEnchant2"
          [(enchant4Id)]="model.accRightEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.A_Right_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.A_Right_2]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
          [isEndWithSpace]="!showCompareItemMap.accRight"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.accRight">
      <div class="col-12">
        <app-equipment
          [itemType]="'accRight'"
          [placeholder]="'AccRight'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accRightList"
          [cardList]="accRightCardList"
          [optionList]="optionList"
          [(itemId)]="model2.accRight"
          [(itemRefine)]="model2.accRightRefine"
          [(card1Id)]="model2.accRightCard"
          [(itemGrade)]="model2.accRightGrade"
          [(enchant2Id)]="model2.accRightEnchant1"
          [(enchant3Id)]="model2.accRightEnchant2"
          [(enchant4Id)]="model2.accRightEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.A_Right_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.A_Right_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
          [isEndWithSpace]="true"
        ></app-equipment>
      </div>
    </div>

    <!-- Acc Left -->
    <div class="grid grid-nogutter item_label_acc">
      <div class="col-12">
        <app-equipment
          [itemType]="'accLeft'"
          [placeholder]="'AccLeft'"
          [overlayLabel]="'Left'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accLeftList"
          [cardList]="accLeftCardList"
          [optionList]="optionList"
          [(itemId)]="model.accLeft"
          [(itemRefine)]="model.accLeftRefine"
          [(card1Id)]="model.accLeftCard"
          [(itemGrade)]="model.accLeftGrade"
          [(enchant2Id)]="model.accLeftEnchant1"
          [(enchant3Id)]="model.accLeftEnchant2"
          [(enchant4Id)]="model.accLeftEnchant3"
          [(option1Value)]="model.rawOptionTxts[itemOptionNumber.A_Left_1]"
          [(option2Value)]="model.rawOptionTxts[itemOptionNumber.A_Left_2]"
          (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
          (clearItemEvent)="onClearItem($event)"
          (gradeChange)="onSelectGrade($event.itemType, $event.itemId, $event.grade)"
          (optionChange)="onOptionChange()"
        ></app-equipment>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.accLeft">
      <div class="col-12">
        <app-equipment
          [itemType]="'accLeft'"
          [placeholder]="'AccLeft'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accLeftList"
          [cardList]="accLeftCardList"
          [optionList]="optionList"
          [(itemId)]="model2.accLeft"
          [(itemRefine)]="model2.accLeftRefine"
          [(card1Id)]="model2.accLeftCard"
          [(itemGrade)]="model2.accLeftGrade"
          [(enchant2Id)]="model2.accLeftEnchant1"
          [(enchant3Id)]="model2.accLeftEnchant2"
          [(enchant4Id)]="model2.accLeftEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.A_Left_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.A_Left_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
          (gradeChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Pet / Costume -->
    <div class="grid grid-nogutter mt-3">
      <!-- Upper -->
      <div class="col-12 grid grid-nogutter item_label_costume">
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeUpper'"
            [placeholder]="'Costume Upper'"
            [itemList]="costumeUpperList"
            [(itemId)]="model.costumeUpper"
            (selectItemChange)="onSelectItem('costumeUpper', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantUpper'"
            [placeholder]="'Upper Enchant'"
            [itemList]="costumeEnhUpperList"
            [(itemId)]="model.costumeEnchantUpper"
            (selectItemChange)="onSelectItem('costumeEnchantUpper', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>

        <div class="col-3 col-offset-3 item_label_pet">
          <p-dropdown
            inputId="pet"
            [autoDisplayFirst]="false"
            [resetFilterOnHide]="true"
            [options]="petList"
            [filter]="true"
            filterBy="label"
            scrollHeight="350px"
            [(ngModel)]="model.pet"
            [showClear]="true"
            (onChange)="onSelectItem('pet', $event.value)"
            placeholder="Pet"
          >
            <ng-template let-item pTemplate="selectedItem">
              <div class="flex gap-1 item_template" *ngIf="model.pet">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
            <ng-template let-item pTemplate="item">
              <div class="flex gap-1">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>

      <!-- Middle -->
      <div class="col-9 grid grid-nogutter item_label_costume">
        <div class="col-4">
          <app-equipment-cos-enchant
            [itemType]="'costumeMiddle'"
            [placeholder]="'Costume Middle'"
            [itemList]="costumeMiddleList"
            [(itemId)]="model.costumeMiddle"
            (selectItemChange)="onSelectItem('costumeMiddle', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-4">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantMiddle'"
            [placeholder]="'Middle Enchant'"
            [itemList]="costumeEnhMiddleList"
            [(itemId)]="model.costumeEnchantMiddle"
            (selectItemChange)="onSelectItem('costumeEnchantMiddle', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
      </div>

      <!-- Lower -->
      <div class="col-9 grid grid-nogutter item_label_costume">
        <div class="col-4">
          <app-equipment-cos-enchant
            [itemType]="'costumeLower'"
            [placeholder]="'Costume Lower'"
            [itemList]="costumeLowerList"
            [(itemId)]="model.costumeLower"
            (selectItemChange)="onSelectItem('costumeLower', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-4">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantLower'"
            [placeholder]="'Lower Enchant'"
            [itemList]="costumeEnhLowerList"
            [(itemId)]="model.costumeEnchantLower"
            (selectItemChange)="onSelectItem('costumeEnchantLower', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
      </div>

      <!-- Garment -->
      <div class="col-12 grid grid-nogutter mt-2 item_label_costume">
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeGarment'"
            [placeholder]="'Costume Garment'"
            [itemList]="costumeGarmentList"
            [(itemId)]="model.costumeGarment"
            (selectItemChange)="onSelectItem('costumeGarment', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantGarment'"
            [placeholder]="'Garment Enchant'"
            [itemList]="costumeEnhGarmentList"
            [(itemId)]="model.costumeEnchantGarment"
            (selectItemChange)="onSelectItem('costumeEnchantGarment', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantGarment2'"
            [placeholder]="'Garment Enchant 2'"
            [itemList]="costumeEnhGarment2List"
            [(itemId)]="model.costumeEnchantGarment2"
            (selectItemChange)="onSelectItem('costumeEnchantGarment2', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-3">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantGarment4'"
            [placeholder]="'Garment Enchant 4'"
            [itemList]="costumeEnhGarment4List"
            [(itemId)]="model.costumeEnchantGarment4"
            (selectItemChange)="onSelectItem('costumeEnchantGarment4', $event.itemId)"
          ></app-equipment-cos-enchant>
        </div>
      </div>

      <div class="col-9 col-offset-3 grid grid-nogutter item_label_costume flex flex-column">
        <div class="col-4 item_label_compare" *ngIf="showCompareItemMap.costumeEnchantUpper">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantUpper'"
            [placeholder]="'Upper Enchant'"
            [itemList]="costumeEnhUpperList"
            [(itemId)]="model2.costumeEnchantUpper"
            (selectItemChange)="onCompareItemChange()"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-4 item_label_compare" *ngIf="showCompareItemMap.costumeEnchantMiddle">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantMiddle'"
            [placeholder]="'Middle Enchant'"
            [itemList]="costumeEnhMiddleList"
            [(itemId)]="model2.costumeEnchantMiddle"
            (selectItemChange)="onCompareItemChange()"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-4 item_label_compare" *ngIf="showCompareItemMap.costumeEnchantLower">
          <app-equipment-cos-enchant
            [itemType]="'costumeEnchantLower'"
            [placeholder]="'Lower Enchant'"
            [itemList]="costumeEnhLowerList"
            [(itemId)]="model2.costumeEnchantLower"
            (selectItemChange)="onCompareItemChange()"
          ></app-equipment-cos-enchant>
        </div>
        <div class="col-12 grid grid-nogutter item_label_compare">
          <div class="col-4" *ngIf="showCompareItemMap.costumeEnchantGarment">
            <app-equipment-cos-enchant
              [itemType]="'costumeEnchantGarment'"
              [placeholder]="'Garment Enchant'"
              [itemList]="costumeEnhGarmentList"
              [(itemId)]="model2.costumeEnchantGarment"
              (selectItemChange)="onCompareItemChange()"
            ></app-equipment-cos-enchant>
          </div>
          <div class="col-4" *ngIf="showCompareItemMap.costumeEnchantGarment2">
            <app-equipment-cos-enchant
              [itemType]="'costumeEnchantGarment2'"
              [placeholder]="'Garment Enchant 2'"
              [itemList]="costumeEnhGarment2List"
              [(itemId)]="model2.costumeEnchantGarment2"
              (selectItemChange)="onCompareItemChange()"
            ></app-equipment-cos-enchant>
          </div>
          <div class="col-4" *ngIf="showCompareItemMap.costumeEnchantGarment4">
            <app-equipment-cos-enchant
              [itemType]="'costumeEnchantGarment4'"
              [placeholder]="'Garment Enchant 4'"
              [itemList]="costumeEnhGarment4List"
              [(itemId)]="model2.costumeEnchantGarment4"
              (selectItemChange)="onCompareItemChange()"
            ></app-equipment-cos-enchant>
          </div>
        </div>
      </div>
    </div>

    <!-- Shadow -->
    <div class="grid grid-nogutter mt-3">
      <div class="col-12 grid grid-nogutter align-content-start">
        <!-- Shadow Weapon -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowWeapon'"
            [placeholder]="'Shadow Weapon'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowWeaponList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowWeapon"
            [(itemRefine)]="model.shadowWeaponRefine"
            [(enchant3Id)]="model.shadowWeaponEnchant2"
            [(enchant4Id)]="model.shadowWeaponEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_Wp_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <!-- Shadow Shield -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowShield'"
            [placeholder]="'Shadow Shield'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowShieldList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowShield"
            [(itemRefine)]="model.shadowShieldRefine"
            [(enchant3Id)]="model.shadowShieldEnchant2"
            [(enchant4Id)]="model.shadowShieldEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_Sh_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <!-- Shadow Armor -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowArmor'"
            [placeholder]="'Shadow Armor'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowArmorList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowArmor"
            [(itemRefine)]="model.shadowArmorRefine"
            [(enchant3Id)]="model.shadowArmorEnchant2"
            [(enchant4Id)]="model.shadowArmorEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_Ar_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <!-- Shadow Boot -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowBoot'"
            [placeholder]="'Shadow Boot'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowBootList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowBoot"
            [(itemRefine)]="model.shadowBootRefine"
            [(enchant3Id)]="model.shadowBootEnchant2"
            [(enchant4Id)]="model.shadowBootEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_B_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <!-- Shadow Earring -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowEarring'"
            [placeholder]="'Shadow Earring'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowEarringList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowEarring"
            [(itemRefine)]="model.shadowEarringRefine"
            [(enchant3Id)]="model.shadowEarringEnchant2"
            [(enchant4Id)]="model.shadowEarringEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_Ear_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <!-- Shadow Pendant -->
        <div class="col-12 item_label_shadow">
          <app-equipment-shadow
            [itemType]="'shadowPendant'"
            [placeholder]="'Shadow Pendant'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowPendantList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model.shadowPendant"
            [(itemRefine)]="model.shadowPendantRefine"
            [(enchant3Id)]="model.shadowPendantEnchant2"
            [(enchant4Id)]="model.shadowPendantEnchant3"
            [(optionValue)]="model.rawOptionTxts[itemOptionNumber.SD_Pan_1]"
            (selectItemChange)="onSelectItem($event.itemType, $event.itemId, $event.refine)"
            (clearItemEvent)="onClearItem($event)"
            (optionChange)="onOptionChange()"
          ></app-equipment-shadow>
        </div>

        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowWeapon">
          <app-equipment-shadow
            [itemType]="'shadowWeapon'"
            [placeholder]="'Shadow Weapon'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowWeaponList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowWeapon"
            [(itemRefine)]="model2.shadowWeaponRefine"
            [(enchant3Id)]="model2.shadowWeaponEnchant2"
            [(enchant4Id)]="model2.shadowWeaponEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_Wp_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowShield">
          <app-equipment-shadow
            [itemType]="'shadowShield'"
            [placeholder]="'Shadow Shield'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowShieldList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowShield"
            [(itemRefine)]="model2.shadowShieldRefine"
            [(enchant3Id)]="model2.shadowShieldEnchant2"
            [(enchant4Id)]="model2.shadowShieldEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_Sh_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowArmor">
          <app-equipment-shadow
            [itemType]="'shadowArmor'"
            [placeholder]="'Shadow Armor'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowArmorList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowArmor"
            [(itemRefine)]="model2.shadowArmorRefine"
            [(enchant3Id)]="model2.shadowArmorEnchant2"
            [(enchant4Id)]="model2.shadowArmorEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_Ar_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowBoot">
          <app-equipment-shadow
            [itemType]="'shadowBoot'"
            [placeholder]="'Shadow Boot'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowBootList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowBoot"
            [(itemRefine)]="model2.shadowBootRefine"
            [(enchant3Id)]="model2.shadowBootEnchant2"
            [(enchant4Id)]="model2.shadowBootEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_B_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowEarring">
          <app-equipment-shadow
            [itemType]="'shadowEarring'"
            [placeholder]="'Shadow Earring'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowEarringList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowEarring"
            [(itemRefine)]="model2.shadowEarringRefine"
            [(enchant3Id)]="model2.shadowEarringEnchant2"
            [(enchant4Id)]="model2.shadowEarringEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_Ear_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
        <div class="col-12 item_label_compare" *ngIf="showCompareItemMap.shadowPendant">
          <app-equipment-shadow
            [itemType]="'shadowPendant'"
            [placeholder]="'Shadow Pendant'"
            [items]="items"
            [mapEnchant]="mapEnchant"
            [itemList]="shadowPendantList"
            [refineList]="shadowRefineList"
            [optionList]="basicOptions"
            [(itemId)]="model2.shadowPendant"
            [(itemRefine)]="model2.shadowPendantRefine"
            [(enchant3Id)]="model2.shadowPendantEnchant2"
            [(enchant4Id)]="model2.shadowPendantEnchant3"
            [(optionValue)]="model2.rawOptionTxts[itemOptionNumber.SD_Pan_1]"
            (selectItemChange)="onCompareItemChange()"
            (optionChange)="onCompareItemChange()"
          ></app-equipment-shadow>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Side -->
  <div class="p-fluid col-5">
    <p-accordion [multiple]="true" [activeIndex]="[2, 7]">
      <p-accordionTab header="Consumables" class="consumable">
        <div class="grid grid-nogutter">
          <!-- Consumable -->
          <div class="col-4">
            <p-listbox [options]="consumableList" [(ngModel)]="model.consumables" [multiple]="true" [metaKeySelection]="false" (onChange)="onConsumableChange()">
              <ng-template let-item pTemplate="item">
                <div class="flex gap-2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div class="text_ellips">{{ item.label }}</div>
                </div>
              </ng-template>
            </p-listbox>
          </div>

          <div class="col-4">
            <div class="grid grid-nogutter column_list">
              <div *ngFor="let con of consumableList2; let i = index" class="col-12">
                <p-listbox [options]="con" [(ngModel)]="model.consumables2[i]" [multiple]="false" [metaKeySelection]="false" (onChange)="onConsumableChange()">
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
            </div>
          </div>

          <div class="col-4">
            <div class="grid grid-nogutter">
              <div class="col-12">
                <p-listbox [options]="aspdPotionList" [(ngModel)]="model.aspdPotion" [multiple]="false" [metaKeySelection]="false" (onChange)="onConsumableChange()">
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
              <div class="col-12">
                <p-listbox [options]="aspdPotionList2" [(ngModel)]="model.aspdPotions" [multiple]="true" [metaKeySelection]="false" (onChange)="onConsumableChange()">
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Skills ***กดอัพสกิลด้วยนะ เพราะไอเทมบางชิ้นต้องอัพสกิลถึงจะได้ bonus" class="select_skill">
        <div class="grid grid-nogutter">
          <!--  Buffs -->
          <div class="col-4">
            <p-tag severity="info" value="Buffs"></p-tag>
            <span class="skill_debuff pl-2">สีแดง = Debuff monster</span>
            <div class="grid grid-nogutter">
              <div *ngFor="let bishopBuff of skillBuffs; let i = index" class="col-12">
                <div [ngSwitch]="bishopBuff.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips {{ bishopBuff.isDebuff ? 'skill_debuff' : '' }}">{{ bishopBuff.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="bishopBuff.dropdown"
                        [(ngModel)]="model.skillBuffs[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                        scrollHeight="380px"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips {{ bishopBuff.isDebuff ? 'skill_debuff' : '' }}">{{ bishopBuff.label }}</span>
                      <p-selectButton
                        [options]="bishopBuff.dropdown"
                        [(ngModel)]="model.skillBuffs[i]"
                        (ngModelChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Learned Skills -->
          <div class="col-4" [hidden]="passiveSkills.length === 0">
            <p-tag severity="warning" value="Learn to get bonuses"></p-tag>
            <div class="grid grid-nogutter">
              <div *ngFor="let passiveSkill of passiveSkills; let i = index" class="col-12">
                <div [ngSwitch]="passiveSkill.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ passiveSkill.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="passiveSkill.dropdown"
                        [(ngModel)]="model.passiveSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                        scrollHeight="380px"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ passiveSkill.label }}</span>
                      <p-selectButton
                        [options]="passiveSkill.dropdown"
                        [(ngModel)]="model.passiveSkills[i]"
                        (ngModelChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Active SKills -->
          <div class="col-4">
            <p-tag severity="danger" value="Activating Skills/Effects"></p-tag>
            <div class="grid grid-nogutter">
              <div *ngFor="let activeSkill of activeSkills; let i = index" class="col-12">
                <div [ngSwitch]="activeSkill.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips {{ activeSkill.isDebuff ? 'skill_debuff' : '' }}">{{ activeSkill.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="activeSkill.dropdown"
                        [(ngModel)]="model.activeSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                        scrollHeight="380px"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips {{ activeSkill.isDebuff ? 'skill_debuff' : '' }}">{{ activeSkill.label }}</span>
                      <p-selectButton
                        [options]="activeSkill.dropdown"
                        [(ngModel)]="model.activeSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Battle Summary">
        <div class="grid grid-nogutter battle_summary">
          <div class="col-12" [hidden]="!chanceList?.length">
            <p-fieldset legend="Has a chance" [toggleable]="true">
              <div *ngFor="let category of chanceList" class="field-checkbox my-2">
                <p-checkbox
                  name="group"
                  [value]="category.name"
                  [(ngModel)]="selectedChances"
                  [inputId]="category.name"
                  (ngModelChange)="onSelecteChance($event)"
                ></p-checkbox>
                <label class="font-semibold summary_chance" [for]="category.name">{{ category.label }}</label
                ><i class="pi pi-arrow-right px-1"></i>
                <span>{{ category.label2 }}</span>
              </div>
            </p-fieldset>
          </div>

          <!-- Monster -->
          <div class="col-5">
            <div class="grid grid-nogutter">
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon monster_hilight_label">Monster</span>
                  <p-dropdown
                    inputId="monsterOpponent"
                    [autoDisplayFirst]="false"
                    [resetFilterOnHide]="true"
                    [options]="groupMonsterList"
                    [filter]="true"
                    filterBy="label,searchVal"
                    [group]="true"
                    scrollHeight="400px"
                    [(ngModel)]="selectedMonster"
                    (onChange)="onMonsterChange()"
                  >
                    <ng-template let-group pTemplate="group">
                      <div class="flex align-items-center font-bold dropdown_monster_group_label">
                        <span>{{ group.label }}</span>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  <!-- <button
                    type="button"
                    class="p-button-success"
                    pButton
                    label="Choose Monster"
                    [loading]="isInProcessingPreset"
                    (click)="onClickMonster()"
                  ></button> -->
                </div>
              </div>
              <!-- <div class="col-12">{{ selectedMonsterName }}</div> -->
              <div class="col-5 flex align-items-center justify-content-center">
                <div class="grid grid-nogutter" style="height: 100%; width: 100%">
                  <div class="col-12 flex align-items-center justify-content-center">
                    <img src="https://static.divine-pride.net/images/mobs/png/{{ selectedMonster }}.png" class="img_monster" alt="-" />
                  </div>
                </div>
              </div>
              <div class="col-7">
                <app-battle-monster-summary
                  [totalSummary]="totalSummary"
                  [isInProcessingPreset]="isInProcessingPreset"
                  (showElementTableClick)="onShowElementalTableClick()"
                ></app-battle-monster-summary>
              </div>
            </div>
          </div>

          <!-- Skill -->
          <div class="col-7">
            <div class="grid grid-nogutter" style="position: relative">
              <div class="col-12 skill-selection" [hidden]="isShowSelectableSkillLevel">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon skill_hilight_label">Skill</span>
                  <p-dropdown
                    inputId="skill"
                    [autoDisplayFirst]="false"
                    [resetFilterOnHide]="true"
                    [options]="atkSkills"
                    scrollHeight="400px"
                    [(ngModel)]="model.selectedAtkSkill"
                    (onChange)="onAtkSkillChange()"
                  ></p-dropdown>
                </div>
              </div>
              <div class="col-12 skill-selection" [hidden]="!isShowSelectableSkillLevel">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon skill_hilight_label">Skill</span>
                  <p-cascadeSelect
                    inputId="skill"
                    [(ngModel)]="model.selectedAtkSkill"
                    [options]="atkSkillCascades"
                    optionValue="value"
                    optionLabel="label"
                    optionGroupLabel="label"
                    [optionGroupChildren]="['levelList']"
                    placeholder="-"
                    (onChange)="onAtkSkillChange()"
                  ></p-cascadeSelect>
                </div>
              </div>
              <div class="col-12">
                <app-battle-dmg-summary
                  [model]="model"
                  [totalSummary]="totalSummary"
                  [totalSummary2]="totalSummary2"
                  [isCalculating]="isCalculating"
                  [isEnableCompare]="isEnableCompare"
                  [isInProcessingPreset]="isInProcessingPreset"
                  [selectedChances]="selectedChances"
                  [hideBasicAtk]="hideBasicAtk"
                  [showLeftWeapon]="showLeftWeapon"
                  (showElementTableClick)="onShowElementalTableClick()"
                ></app-battle-dmg-summary>
              </div>
            </div>
          </div>

          <!-- Table -->
          <div class="col-12 damage_table">
            <p-table
              styleClass="p-datatable-striped"
              filterValue="label"
              [columns]="selectedColumns"
              [value]="calcDamages"
              [loading]="isCalculating"
              [tableStyle]="{ 'min-width': '40rem' }"
            >
              <ng-template pTemplate="caption">
                <div class="grid grid-nogutter">
                  <div class="col-6">
                    <p-multiSelect
                      [options]="groupMonsterList"
                      [group]="true"
                      [(ngModel)]="selectedMonsterIds"
                      [filter]="true"
                      filterBy="label,searchVal"
                      [showClear]="true"
                      [showToggleAll]="false"
                      scrollHeight="400px"
                      selectedItemsLabel="{0} monsters selected"
                      placeholder="Choose Monsters"
                      [maxSelectedLabels]="2"
                      (onChange)="onMonsterListChange()"
                      (onClear)="onMonsterListChange()"
                    >
                      <ng-template let-group pTemplate="group">
                        <div class="flex align-items-center font-bold dropdown_monster_group_label">
                          <span>{{ group.label }}</span>
                        </div>
                      </ng-template>
                    </p-multiSelect>
                  </div>
                  <div class="col-6">
                    <p-multiSelect
                      [options]="cols"
                      [(ngModel)]="selectedColumns"
                      optionLabel="header"
                      selectedItemsLabel="{0} columns selected"
                      placeholder="Choose Columns"
                      [maxSelectedLabels]="5"
                      (onChange)="onSelectedColChange()"
                      (onClear)="onSelectedColChange()"
                    ></p-multiSelect>
                  </div>
                </div>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th>Name</th>
                  <th *ngFor="let col of columns">
                    {{ col.header }}
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item let-columns="columns">
                <tr>
                  <td class="{{ 'property_' + item.elementName }}">{{ item.label }}</td>
                  <td *ngFor="let col of columns" class="battle_row_{{ col.field }}">
                    {{ item[col.field] > 0 ? (item[col.field] | number) : item[col.field] }}
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Skill bonus / Multiplier Summary">
        <app-misc-detail
          [elementTable]="elementTable"
          [raceTable]="raceTable"
          [sizeTable]="sizeTable"
          [classTable]="classTable"
          [atkTypeTable]="atkTypeTable"
          [skillMultiplierTable]="skillMultiplierTable"
        ></app-misc-detail>
      </p-accordionTab>
      <p-accordionTab header="Penetration Summary">
        <app-misc-detail [elementTable]="[]" [raceTable]="peneRaceTable" [sizeTable]="[]" [classTable]="peneClassTable" [skillMultiplierTable]="[]"></app-misc-detail>
      </p-accordionTab>

      <p-accordionTab header="Summary">
        <div class="grid grid-nogutter" style="overflow: auto">
          <div class="col-6 json_display">
            <pre [innerHTML]="modelSummary | prettyjson: [true, 3]"></pre>
            <pre *ngIf="isEnableCompare" [innerHTML]="model2 | prettyjson: [true, 3]"></pre>
          </div>
          <div class="col-6 json_display">
            <pre [innerHTML]="totalSummary | prettyjson: [true, 3]"></pre>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Equipments Summary">
        <div class="grid grid-nogutter">
          <div class="col-6 json_display">
            <pre [innerHTML]="itemSummary | prettyjson: [true, 3]"></pre>
          </div>
          <div class="col-6 json_display">
            <pre [innerHTML]="itemSummary2 | prettyjson: [true, 3]"></pre>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Item Descriptions">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <div class="item_label_compare" *ngIf="isEnableCompare && equipCompareItems?.length">
              <p-listbox
                [options]="equipCompareItems"
                [(ngModel)]="selectedCompareItemDesc"
                [metaKeySelection]="false"
                [listStyle]="{ 'max-height': '700px' }"
                (onChange)="onSelectItemDescription(true)"
              >
                <ng-template let-item pTemplate="item">
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.id }}.png" alt="" class="item_img" />
                    <div class="text_ellips">
                      {{ item.label }}
                    </div>
                  </div>
                </ng-template>
              </p-listbox>
            </div>
            <p-listbox
              [options]="equipItems"
              [(ngModel)]="selectedItemDesc"
              [metaKeySelection]="false"
              [listStyle]="{ 'max-height': '700px' }"
              (onChange)="onSelectItemDescription()"
            >
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1 item_template item_label_{{ item.value }}" style="background-color: var(--border-radius)">
                  <img src="assets/demo/images/items/{{ item.id }}.png" alt="" class="item_img" />
                  <div class="text_ellips">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
            </p-listbox>
          </div>
          <div class="col-8">
            <div class="grid grid-nogutter ml-2" style="max-height: 700px; overflow: auto">
              <div class="col-12 json_display">
                ItemID: {{ itemId }}
                <pre [innerHTML]="itemBonus | prettyjson: [true, 3]"></pre>
              </div>
              <div class="col-12 px-2 py-2" style="color: #000; background-color: #fff" [innerHTML]="itemDescription"></div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>
</div>
