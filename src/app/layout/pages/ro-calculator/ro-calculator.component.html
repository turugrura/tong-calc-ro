<p-toast></p-toast>
<p-blockUI [blocked]="isInProcessingPreset"></p-blockUI>
<p-confirmDialog [position]="'top'" [style]="{ width: '25vw' }"></p-confirmDialog>

<div class="grid grid-nogutter">
  <!-- Left Side -->
  <div class="p-fluid col-7">
    <!-- Create Update Class -->
    <div class="grid grid-nogutter">
      <div class="col-4">
        <div class="grid grid-nogutter">
          <div class="col-12">
            <div class="p-inputgroup">
              <input #presetName [autocomplete]="false" type="text" pInputText placeholder="Name" />
              <button
                type="button"
                class="p-button-success"
                pButton
                label="Save"
                [loading]="isInProcessingPreset"
                [disabled]="!presetName.value"
                (click)="updatePreset(presetName.value)"
              ></button>
              <button
                type="button"
                class="p-button-secondary"
                pButton
                icon="pi pi-cog"
                [loading]="isInProcessingPreset"
                (click)="openPresetManagement()"
              ></button>
            </div>
          </div>
          <div class="col-12">
            <div class="p-inputgroup">
              <p-dropdown
                [autoDisplayFirst]="false"
                [options]="preSets"
                [filter]="true"
                filterBy="label"
                placeholder="Presets"
                [(ngModel)]="selectedPreset"
              ></p-dropdown>
              <p-splitButton
                styleClass="p-button-help"
                icon="pi pi-download"
                label="Load"
                (onClick)="loadPreset()"
                [disabled]="!selectedPreset || isInProcessingPreset"
                [model]="loadBtnItems"
              ></p-splitButton>
            </div>
          </div>

          <div class="col-12">
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon" style="width: 80px">Class</span>
              <p-dropdown
                inputId="character"
                [autoDisplayFirst]="false"
                [resetFilterOnHide]="true"
                [options]="characterList"
                [filter]="true"
                filterBy="label"
                [(ngModel)]="model.class"
                placeholder="Class"
                (onChange)="onClassChange()"
              ></p-dropdown>
            </div>
          </div>
          <div class="col-12">
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon" style="width: 80px">Level</span>
              <p-dropdown
                inputId="level"
                [autoDisplayFirst]="false"
                [resetFilterOnHide]="true"
                [options]="levelList"
                [filter]="true"
                filterBy="label"
                [(ngModel)]="model.level"
                (ngModelChange)="onBaseStatusChange()"
              ></p-dropdown>
            </div>
          </div>
          <div class="col-12">
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon" style="width: 80px">Job</span>
              <p-dropdown
                inputId="jobLevel"
                [autoDisplayFirst]="false"
                [options]="jobList"
                [filter]="true"
                filterBy="label"
                [resetFilterOnHide]="true"
                [(ngModel)]="model.jobLevel"
                (ngModelChange)="onJobLevelChange()"
              ></p-dropdown>
            </div>
          </div>
          <div class="col-12">
            <span class="p-inputgroup-addon"
              >Available Point:
              <span [className]="availablePoints < 0 ? 'ml-2 summary_monster_value px-1 font-semibold' : 'ml-2'">
                {{ availablePoints }}</span
              ></span
            >
          </div>
        </div>
      </div>

      <!-- Status -->
      <div class="col-8">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <div class="grid grid-nogutter">
              <!-- STR -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Str</span>
                  <p-dropdown
                    inputId="str"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.str"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobStr || 0) + (totalSummary?.str || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
              <!-- AGI -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Agi</span>
                  <p-dropdown
                    inputId="agi"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.agi"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobAgi || 0) + (totalSummary?.agi || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
              <!-- VIT -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Vit</span>
                  <p-dropdown
                    inputId="vit"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.vit"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobVit || 0) + (totalSummary?.vit || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
              <!-- INT -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Int</span>
                  <p-dropdown
                    inputId="int"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.int"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobInt || 0) + (totalSummary?.int || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
              <!-- DEX -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Dex</span>
                  <p-dropdown
                    inputId="dex"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.dex"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobDex || 0) + (totalSummary?.dex || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
              <!-- LUK -->
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon" style="width: 45px">Luk</span>
                  <p-dropdown
                    inputId="luk"
                    [autoDisplayFirst]="false"
                    [options]="mainStatusList"
                    [filter]="true"
                    filterBy="label"
                    [resetFilterOnHide]="true"
                    [(ngModel)]="model.luk"
                    (ngModelChange)="onBaseStatusChange()"
                  ></p-dropdown>
                  <p-badge
                    value="+{{ (model.jobLuk || 0) + (totalSummary?.luk || 0) }}"
                    size="large"
                    severity="info"
                  ></p-badge>
                </div>
              </div>
            </div>
          </div>

          <!-- Summary -->
          <div class="col-8">
            <div class="grid grid-nogutter" style="position: relative">
              <div class="loading_block" *ngIf="isCalculating">
                <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
              </div>
              <div class="col-6">
                <div class="grid grid-nogutter mx-2">
                  <div class="col-12">
                    Alt+Q Atk:
                    <span class="font-semibold px-1 summary_stat_atk">
                      {{ totalSummary?.calc?.totalStatusAtk || 0 }} +
                      {{
                        totalSummary?.weapon?.baseWeaponAtk +
                          totalSummary?.weapon?.refineBonus +
                          totalSummary?.calc?.totalMasteryAtk +
                          totalSummary?.calc?.totalEquipAtk || 0
                      }}
                    </span>
                  </div>
                  <div [hidden]="env.production" class="col-12">
                    Equip Atk:
                    <span class="font-semibold px-1 summary_stat_atk"
                      >{{ totalSummary?.atk || 0 }} + {{ totalSummary?.atkPercent || 0 }} %</span
                    >
                  </div>
                  <div class="col-12">
                    ASPD:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalAspd || 0 }}</span>
                    <span class="font-semibold px-1 summary_highlight"
                      >( {{ totalSummary?.calc?.hitPerSecs || 0 }} Hits/s )</span
                    >
                  </div>
                  <div class="col-12">
                    Hit:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalHit || 0 }}</span>
                    Perfect:
                    <span class="font-semibold px-1 summary_stat_atk"
                      >{{ totalSummary?.calc?.totalPerfectHit || 0 }} %</span
                    >
                  </div>
                  <div class="col-12">
                    CriRate:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.calc?.totalCri || 0 }} %</span>
                    Dmg: <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.criDmg || 0 }} %</span>
                  </div>
                  <div class="col-12">
                    Melee:
                    <span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.melee || 0 }} %</span> Range:
                    <Span class="font-semibold px-1 summary_stat_atk">{{ totalSummary?.range || 0 }} %</Span>
                  </div>
                  <div class="col-12">
                    Def:
                    <span class="font-semibold px-1 summary_stat_def"
                      >{{ totalSummary?.calc?.softDef || 0 }} + {{ totalSummary?.calc?.def || 0 }}</span
                    >
                  </div>
                  <div class="col-12">
                    Mdef:
                    <span class="font-semibold px-1 summary_stat_def"
                      >{{ totalSummary?.calc?.softMdef || 0 }} + {{ totalSummary?.calc?.mdef || 0 }}</span
                    >
                  </div>
                  <div class="col-12">
                    Flee:
                    <span class="font-semibold px-1 summary_stat_def"
                      >{{ totalSummary?.calc?.totalFlee || 0 }} + {{ totalSummary?.calc?.totalPerfectDodge || 0 }}</span
                    >
                  </div>
                </div>
              </div>
              <div class="col-6">
                <div class="grid grid-nogutter mx-2">
                  <div class="col-12">
                    Alt+Q Matk:
                    <span class="font-semibold px-1 summary_stat_matk"
                      >{{ totalSummary?.calc?.totalStatusMatk || 0 }} +
                      {{
                        totalSummary?.weapon?.baseWeaponMatk +
                          (totalSummary?.weapon?.refineBonus || 0) +
                          (totalSummary?.calc?.leftWeaponRefineBonus || 0) +
                          (totalSummary?.matk || 0)
                      }}</span
                    >
                  </div>
                  <div [hidden]="env.production" class="col-12">
                    Equip Matk:
                    <span class="font-semibold px-1 summary_stat_matk"
                      >{{ totalSummary?.matk || 0 }} + {{ totalSummary?.matkPercent || 0 }} %</span
                    >
                  </div>
                  <div class="col-12">
                    After Cast Delay:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.acd || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Fixed Cast Time:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.fct || 0 }}</span>
                  </div>
                  <div class="col-12">
                    Variable Cast Time:
                    <span class="font-semibold px-1 summary_stat_matk">{{ totalSummary?.vct || 0 }}</span>
                  </div>
                  <div class="col-12" *ngIf="!env.production">
                    <div class="grid grid-nogutter">
                      <div class="col-12">
                        HP:
                        <span class="font-semibold px-1 summary_stat_def">{{ totalSummary?.calc?.maxHp || 0 }}</span>
                      </div>
                      <div class="col-12">
                        SP:
                        <span class="font-semibold px-1 summary_stat_def">{{ totalSummary?.calc?.maxSp || 0 }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12 item_label_compare">
                <p-multiSelect
                  [options]="compareItemList"
                  [(ngModel)]="compareItemNames"
                  [showClear]="true"
                  [showHeader]="false"
                  [showToggleAll]="false"
                  selectedItemsLabel="{0} slot selected"
                  placeholder="Enable item slot to compare"
                  [maxSelectedLabels]="6"
                  (onChange)="onListItemComparingChange()"
                  (onClear)="onListItemComparingChange(true)"
                ></p-multiSelect>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Weapon + Ammo -->
    <div class="grid grid-nogutter item_label_weapon_main">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="weapon"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('weapon', $event.value, model.weaponRefine)"
              (onClear)="onClearItem('weapon')"
              placeholder="Weapon"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.weapon">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-8" style="min-width: 100px">
            <p-dropdown
              [options]="propertyAtkList"
              [(ngModel)]="model.propertyAtk"
              [disabled]="!model.weapon"
              [showClear]="true"
              placeholder="Element convert"
              (onChange)="onPropertyAtkChange()"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1" *ngIf="model.propertyAtk">
                  <!-- <div class="{{ 'property_' + item.element }}">
                    {{ item.label }}
                  </div> -->
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.img }}.png" alt="" class="item_img" />
                    <div class="{{ 'property_' + item.element }}">{{ item.label }}</div>
                  </div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.img }}.png" alt="" class="item_img" />
                    <div class="{{ 'property_' + item.element }}">{{ item.label }}</div>
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              inputId="weaponRefine"
              [options]="refineList"
              [(ngModel)]="model.weaponRefine"
              [disabled]="!model.weapon"
              (onChange)="onSelectItem('weapon', model.weapon, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-10" [hidden]="hiddenMap.ammu">
            <p-dropdown
              inputId="ammo"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="ammoList"
              [showClear]="true"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.ammo"
              (onChange)="onSelectItem('ammo', $event.value)"
              placeholder="Ammo"
              [disabled]="!model.weapon"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.ammo">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div class="{{ 'property_' + item.element }}">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div class="{{ 'property_' + item.element }}">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="weaponCard1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.weaponCard1"
              [disabled]="!model.weapon || itemSlotsMap.weapon < 1"
              [showClear]="true"
              (onChange)="onSelectItem('weaponCard1', $event.value)"
              placeholder="Card 1"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.weaponCard1">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4">
            <p-dropdown
              inputId="weaponCard2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.weaponCard2"
              [disabled]="!model.weapon || itemSlotsMap.weapon < 2"
              [showClear]="true"
              (onChange)="onSelectItem('weaponCard2', $event.value)"
              placeholder="Card 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.weaponCard2">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="itemSlotsMap.weapon < 3">
            <p-dropdown
              inputId="weaponCard3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.weaponCard3"
              [disabled]="!model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('weaponCard3', $event.value)"
              placeholder="Card3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.weaponCard3">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="itemSlotsMap.weapon < 4">
            <p-dropdown
              inputId="weaponCard3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.weaponCard4"
              [disabled]="!model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('weaponCard4', $event.value)"
              placeholder="Card 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.weaponCard4">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div
            class="col-12"
            [hidden]="
              (weaponEnchant1List.length === 0 && weaponEnchant2List.length === 0 && weaponEnchant3List.length === 0) ||
              !model.weapon
            "
          >
            <div class="grid grid-nogutter">
              <div class="col-4">
                <p-dropdown
                  inputId="weaponEnchant1"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="weaponEnchant1List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.weaponEnchant1"
                  [showClear]="true"
                  [disabled]="weaponEnchant1List.length === 0 || !model.weapon"
                  (onChange)="onSelectItem('weaponEnchant1', $event.value)"
                  placeholder="Enchant 2"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.weaponEnchant1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="col-4">
                <p-dropdown
                  inputId="weaponEnchant2"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="weaponEnchant2List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.weaponEnchant2"
                  [showClear]="true"
                  [disabled]="weaponEnchant2List.length === 0 || !model.weapon"
                  (onChange)="onSelectItem('weaponEnchant2', $event.value)"
                  placeholder="Enchant 3"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.weaponEnchant2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="col-4">
                <p-dropdown
                  inputId="weaponEnchant3"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="weaponEnchant3List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.weaponEnchant3"
                  [showClear]="true"
                  [disabled]="weaponEnchant3List.length === 0 || !model.weapon"
                  (onChange)="onSelectItem('weaponEnchant3', $event.value)"
                  placeholder="Enchant 4"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.weaponEnchant3">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="grid grid-nogutter">
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Left_1]"
                  [disabled]="!model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 1"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Left_2]"
                  [disabled]="!model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 2"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Left_3]"
                  [disabled]="!model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 3"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_leftWeapon_main" *ngIf="showLeftWeapon">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="leftWeapon"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="leftWeaponList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.leftWeapon"
              [disabled]="!model.weapon || !!model.shield"
              [showClear]="true"
              (onChange)="onSelectItem('leftWeapon', $event.value, model.leftWeaponRefine)"
              (onClear)="onClearItem('leftWeapon')"
              placeholder="Left Weapon"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.leftWeapon">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              inputId="leftWeaponRefine"
              [options]="refineList"
              [(ngModel)]="model.leftWeaponRefine"
              [disabled]="!model.leftWeapon"
              (onChange)="onSelectItem('leftWeapon', model.leftWeapon, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4" [hidden]="itemSlotsMap.leftWeapon < 1">
            <p-dropdown
              inputId="leftWeaponCard1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.leftWeaponCard1"
              [disabled]="!model.leftWeapon || !model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('leftWeaponCard1', $event.value)"
              placeholder="Card 1"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.leftWeaponCard1">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="itemSlotsMap.leftWeapon < 2">
            <p-dropdown
              inputId="leftWeaponCard2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.leftWeaponCard2"
              [disabled]="!model.leftWeapon || !model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('leftWeaponCard2', $event.value)"
              placeholder="Card 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.leftWeaponCard2">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="itemSlotsMap.leftWeapon < 3">
            <p-dropdown
              inputId="leftWeaponCard3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.leftWeaponCard3"
              [disabled]="!model.leftWeapon || !model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('leftWeaponCard3', $event.value)"
              placeholder="Card3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.leftWeaponCard3">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="itemSlotsMap.leftWeapon < 4">
            <p-dropdown
              inputId="leftWeaponCard4"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="weaponCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.leftWeaponCard4"
              [disabled]="!model.leftWeapon || !model.weapon"
              [showClear]="true"
              (onChange)="onSelectItem('leftWeaponCard4', $event.value)"
              placeholder="Card 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.leftWeaponCard4">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div
            class="col-12"
            [hidden]="
              (leftWeaponEnchant1List.length === 0 &&
                leftWeaponEnchant2List.length === 0 &&
                leftWeaponEnchant3List.length === 0) ||
              !model.leftWeapon
            "
          >
            <div class="grid grid-nogutter">
              <div class="col-4">
                <p-dropdown
                  inputId="leftWeaponEnchant1"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="leftWeaponEnchant1List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.leftWeaponEnchant1"
                  [showClear]="true"
                  [disabled]="leftWeaponEnchant1List.length === 0 || !model.leftWeapon || !model.weapon"
                  (onChange)="onSelectItem('leftWeaponEnchant1', $event.value)"
                  placeholder="Enchant 2"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.leftWeaponEnchant1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="col-4">
                <p-dropdown
                  inputId="leftWeaponEnchant2"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="leftWeaponEnchant2List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.leftWeaponEnchant2"
                  [showClear]="true"
                  [disabled]="leftWeaponEnchant2List.length === 0 || !model.leftWeapon || !model.weapon"
                  (onChange)="onSelectItem('leftWeaponEnchant2', $event.value)"
                  placeholder="Enchant 3"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.leftWeaponEnchant2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="col-4">
                <p-dropdown
                  inputId="leftWeaponEnchant3"
                  [autoDisplayFirst]="false"
                  [resetFilterOnHide]="true"
                  [options]="leftWeaponEnchant3List"
                  [filter]="true"
                  filterBy="label"
                  [(ngModel)]="model.leftWeaponEnchant3"
                  [showClear]="true"
                  [disabled]="leftWeaponEnchant3List.length === 0 || !model.leftWeapon || !model.weapon"
                  (onChange)="onSelectItem('leftWeaponEnchant3', $event.value)"
                  placeholder="Enchant 4"
                >
                  <ng-template let-item pTemplate="selectedItem">
                    <div class="flex gap-1 item_template" *ngIf="model.leftWeaponEnchant3">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-1">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div>{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="grid grid-nogutter">
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Right_1]"
                  [disabled]="!model.leftWeapon || !model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 1"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Right_2]"
                  [disabled]="!model.leftWeapon || !model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 2"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-4">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.W_Right_3]"
                  [disabled]="!model.leftWeapon || !model.weapon"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 3"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.weapon">
      <div class="col-12">
        <app-equipment
          [itemType]="'weapon'"
          [placeholder]="'Weapon'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="weaponList"
          [refineList]="refineList"
          [cardList]="weaponCardList"
          [optionList]="optionList"
          [totalOptions]="3"
          [(itemId)]="model2.weapon"
          [(itemRefine)]="model2.weaponRefine"
          [(card1Id)]="model2.weaponCard1"
          [(card2Id)]="model2.weaponCard2"
          [(card3Id)]="model2.weaponCard3"
          [(card4Id)]="model2.weaponCard4"
          [(enchant2Id)]="model2.weaponEnchant1"
          [(enchant3Id)]="model2.weaponEnchant2"
          [(enchant4Id)]="model2.weaponEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_2]"
          [(option3Value)]="model2.rawOptionTxts[itemOptionNumber.W_Left_3]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Shield -->
    <div class="grid grid-nogutter item_label_shield_main" *ngIf="!hiddenMap.shield">
      <div class="col-3" [hidden]="!model.weapon || !!model.leftWeapon">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="shield"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="shieldList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.shield"
              [disabled]="!model.weapon || !!model.leftWeapon"
              [showClear]="true"
              (onChange)="onSelectItem('shield', $event.value, model.shieldRefine)"
              (onClear)="onClearItem('shield')"
              placeholder="Shield"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.shield">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              [options]="refineList"
              [(ngModel)]="model.shieldRefine"
              [disabled]="!model.shield"
              (onChange)="onSelectItem('shield', model.shield, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9" [hidden]="!model.weapon || !!model.leftWeapon">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="shieldCard"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="shieldCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.shieldCard"
              [disabled]="!model.shield || itemSlotsMap.shield < 1"
              [showClear]="true"
              (onChange)="onSelectItem('shieldCard', $event.value)"
              placeholder="Card"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.shieldCard">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="!(itemTotalOptionMap['shield'] >= 1) || !model.shield">
            <p-cascadeSelect
              [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Shield_1]"
              [disabled]="!model.shield"
              [options]="optionList"
              optionValue="value"
              optionGroupLabel="label"
              optionLabel="label"
              [optionGroupChildren]="['children', 'children', 'children']"
              placeholder="Option 1"
              [showClear]="true"
              (onChange)="onOptionChange()"
              (onClear)="onOptionChange()"
            ></p-cascadeSelect>
          </div>
          <div class="col-4" [hidden]="!(itemTotalOptionMap['shield'] >= 2) || !model.shield">
            <p-cascadeSelect
              [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Shield_2]"
              [disabled]="!model.shield"
              [options]="optionList"
              optionValue="value"
              optionGroupLabel="label"
              optionLabel="label"
              [optionGroupChildren]="['children', 'children', 'children']"
              placeholder="Option 2"
              [showClear]="true"
              (onChange)="onOptionChange()"
              (onClear)="onOptionChange()"
            ></p-cascadeSelect>
          </div>
        </div>
        <div class="grid grid-nogutter" [hidden]="shieldEnchant3List.length === 0 || !model.shield">
          <div class="col-4">
            <p-dropdown
              inputId="shieldEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="shieldEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.shieldEnchant1"
              [showClear]="true"
              [disabled]="shieldEnchant1List.length === 0 || !model.shield"
              (onChange)="onSelectItem('shieldEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.shieldEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4">
            <p-dropdown
              inputId="shieldEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="shieldEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.shieldEnchant2"
              [showClear]="true"
              [disabled]="shieldEnchant2List.length === 0 || !model.shield"
              (onChange)="onSelectItem('shieldEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.shieldEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4">
            <p-dropdown
              inputId="shieldEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="shieldEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.shieldEnchant3"
              [showClear]="true"
              [disabled]="shieldEnchant3List.length === 0 || !model.shield"
              (onChange)="onSelectItem('shieldEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.shieldEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>

    <!-- Head Upper -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="headUpper"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="headUpperList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.headUpper"
              [showClear]="true"
              (onChange)="onSelectItem('headUpper', $event.value, model.headUpperRefine)"
              (onClear)="onClearItem('headUpper')"
              placeholder="Head Upper"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.headUpper">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              [options]="refineList"
              [(ngModel)]="model.headUpperRefine"
              [disabled]="!model.headUpper"
              (onChange)="onSelectItem('headUpper', model.headUpper, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="headUpperCard"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="headCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.headUpperCard"
              [disabled]="!model.headUpper || itemSlotsMap.headUpper < 1"
              [showClear]="true"
              (onChange)="onSelectItem('headUpperCard', $event.value)"
              placeholder="Card"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.headUpperCard">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-8">
            <div class="grid grid-nogutter">
              <div class="col-6" [hidden]="!(itemTotalOptionMap['headUpper'] >= 1) || !model.headUpper">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.H_Upper_1]"
                  [disabled]="!model.headUpper"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 1"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-6" [hidden]="!(itemTotalOptionMap['headUpper'] >= 2) || !model.headUpper">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.H_Upper_2]"
                  [disabled]="!model.headUpper"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 2"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
            </div>
          </div>
          <div class="col-4" [hidden]="headUpperEnchant3List.length === 0 || !model.headUpper">
            <p-dropdown
              inputId="headUpperEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="headUpperEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.headUpperEnchant1"
              [showClear]="true"
              [disabled]="headUpperEnchant1List.length === 0 || !model.headUpper"
              (onChange)="onSelectItem('headUpperEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.headUpperEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="headUpperEnchant3List.length === 0 || !model.headUpper">
            <p-dropdown
              inputId="headUpperEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="headUpperEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.headUpperEnchant2"
              [showClear]="true"
              [disabled]="headUpperEnchant2List.length === 0 || !model.headUpper"
              (onChange)="onSelectItem('headUpperEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.headUpperEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="headUpperEnchant3List.length === 0 || !model.headUpper">
            <p-dropdown
              inputId="headUpperEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="headUpperEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.headUpperEnchant3"
              [showClear]="true"
              [disabled]="headUpperEnchant3List.length === 0 || !model.headUpper"
              (onChange)="onSelectItem('headUpperEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.headUpperEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headUpper">
      <div class="col-12">
        <app-equipment
          [itemType]="'headUpper'"
          [placeholder]="'Upper'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headUpperList"
          [refineList]="refineList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model2.headUpper"
          [(itemRefine)]="model2.headUpperRefine"
          [(card1Id)]="model2.headUpperCard"
          [(enchant2Id)]="model2.headUpperEnchant1"
          [(enchant3Id)]="model2.headUpperEnchant2"
          [(enchant4Id)]="model2.headUpperEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.H_Upper_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.H_Upper_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Head Middle -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-3">
        <p-dropdown
          inputId="headMiddle"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headMiddleList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.headMiddle"
          [showClear]="true"
          (onChange)="onSelectItem('headMiddle', $event.value)"
          (onClear)="onClearItem('headMiddle')"
          placeholder="Middle"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headMiddle">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3">
        <p-dropdown
          inputId="headMiddleCard"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headCardList"
          [filter]="true"
          filterBy="label,cardPrefix"
          [(ngModel)]="model.headMiddleCard"
          [disabled]="!model.headMiddle || itemSlotsMap.headMiddle < 1"
          [showClear]="true"
          (onChange)="onSelectItem('headMiddleCard', $event.value)"
          placeholder="Card"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headMiddleCard">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['headMiddle'] >= 1) || !model.headMiddle">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.H_Mid_1]"
          [disabled]="!model.headMiddle"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 1"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['headMiddle'] >= 2) || !model.headMiddle">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.H_Mid_2]"
          [disabled]="!model.headMiddle"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 2"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headMiddle">
      <div class="col-12">
        <app-equipment
          [itemType]="'headMiddle'"
          [placeholder]="'Middle'"
          [items]="items"
          [itemList]="headMiddleList"
          [cardList]="headCardList"
          [optionList]="optionList"
          [(itemId)]="model2.headMiddle"
          [(card1Id)]="model2.headMiddleCard"
          [(enchant2Id)]="model2.headMiddleEnchant1"
          [(enchant3Id)]="model2.headMiddleEnchant2"
          [(enchant4Id)]="model2.headMiddleEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.H_Mid_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.H_Mid_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Head Lower -->
    <div class="grid grid-nogutter item_label_head">
      <div class="col-3">
        <p-dropdown
          inputId="headLower"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headLowerList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.headLower"
          [showClear]="true"
          (onChange)="onSelectItem('headLower', $event.value)"
          (onClear)="onClearItem('headLower')"
          placeholder="Lower"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headLower">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="headLowerEnchant3List.length === 0 || !model.headLower">
        <p-dropdown
          inputId="headLowerEnchant1"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headLowerEnchant1List"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.headLowerEnchant1"
          [showClear]="true"
          [disabled]="headLowerEnchant1List.length === 0 || !model.headLower"
          (onChange)="onSelectItem('headLowerEnchant1', $event.value)"
          placeholder="Enchant 2"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headLowerEnchant1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="headLowerEnchant3List.length === 0 || !model.headLower">
        <p-dropdown
          inputId="headLowerEnchant2"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headLowerEnchant2List"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.headLowerEnchant2"
          [showClear]="true"
          [disabled]="headLowerEnchant2List.length === 0 || !model.headLower"
          (onChange)="onSelectItem('headLowerEnchant2', $event.value)"
          placeholder="Enchant 3"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headLowerEnchant2">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="headLowerEnchant3List.length === 0 || !model.headLower">
        <p-dropdown
          inputId="headLowerEnchant3"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="headLowerEnchant3List"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.headLowerEnchant3"
          [showClear]="true"
          [disabled]="headLowerEnchant3List.length === 0 || !model.headLower"
          (onChange)="onSelectItem('headLowerEnchant3', $event.value)"
          placeholder="Enchant 4"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.headLowerEnchant3">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.headLower">
      <div class="col-12">
        <app-equipment
          [itemType]="'headLower'"
          [placeholder]="'Lower'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="headLowerList"
          [(itemId)]="model2.headLower"
          [(enchant2Id)]="model2.headLowerEnchant1"
          [(enchant3Id)]="model2.headLowerEnchant2"
          [(enchant4Id)]="model2.headLowerEnchant3"
          (selectItemChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Armor -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="armor"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="armorList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.armor"
              [showClear]="true"
              (onChange)="onSelectItem('armor', $event.value, model.armorRefine)"
              (onClear)="onClearItem('armor')"
              placeholder="Armor"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.armor">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              [options]="refineList"
              [(ngModel)]="model.armorRefine"
              [disabled]="!model.armor"
              (onChange)="onSelectItem('armor', model.armor, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="armorCard"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="armorCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.armorCard"
              [disabled]="!model.armor || itemSlotsMap.armor < 1"
              [showClear]="true"
              (onChange)="onSelectItem('armorCard', $event.value)"
              placeholder="Card"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.armorCard">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-8">
            <div class="grid grid-nogutter">
              <div class="col-6" [hidden]="!(itemTotalOptionMap['armor'] >= 1) || !model.armor">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Armor_1]"
                  [disabled]="!model.armor"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 1"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-6" [hidden]="!(itemTotalOptionMap['armor'] >= 2) || !model.armor">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Armor_2]"
                  [disabled]="!model.armor"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 2"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
            </div>
          </div>
          <div class="col-4" [hidden]="armorEnchant3List.length === 0 || !model.armor">
            <p-dropdown
              inputId="armorEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="armorEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.armorEnchant1"
              [showClear]="true"
              [disabled]="armorEnchant1List.length === 0 || !model.armor"
              (onChange)="onSelectItem('armorEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.armorEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="armorEnchant3List.length === 0 || !model.armor">
            <p-dropdown
              inputId="armorEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="armorEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.armorEnchant2"
              [showClear]="true"
              [disabled]="armorEnchant2List.length === 0 || !model.armor"
              (onChange)="onSelectItem('armorEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.armorEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="armorEnchant3List.length === 0 || !model.armor">
            <p-dropdown
              inputId="armorEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="armorEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.armorEnchant3"
              [showClear]="true"
              [disabled]="armorEnchant3List.length === 0 || !model.armor"
              (onChange)="onSelectItem('armorEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.armorEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.armor">
      <div class="col-12">
        <app-equipment
          [itemType]="'armor'"
          [placeholder]="'Armor'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="armorList"
          [refineList]="refineList"
          [cardList]="armorCardList"
          [optionList]="optionList"
          [(itemId)]="model2.armor"
          [(itemRefine)]="model2.armorRefine"
          [(card1Id)]="model2.armorCard"
          [(enchant2Id)]="model2.armorEnchant1"
          [(enchant3Id)]="model2.armorEnchant2"
          [(enchant4Id)]="model2.armorEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.Armor_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.Armor_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Garment -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="garment"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="garmentList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.garment"
              [showClear]="true"
              (onChange)="onSelectItem('garment', $event.value, model.garmentRefine)"
              (onClear)="onClearItem('garment')"
              placeholder="Garment"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.garment">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              [options]="refineList"
              [(ngModel)]="model.garmentRefine"
              [disabled]="!model.garment"
              (onChange)="onSelectItem('garment', model.garment, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="garmentCard"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="garmentCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.garmentCard"
              [disabled]="!model.garment || itemSlotsMap.garment < 1"
              [showClear]="true"
              (onChange)="onSelectItem('garmentCard', $event.value)"
              placeholder="Card"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.garmentCard">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-8">
            <div class="grid grid-nogutter">
              <div class="col-6" [hidden]="!(itemTotalOptionMap['garment'] >= 1) || !model.garment">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Garment_1]"
                  [disabled]="!model.garment"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 1"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
              <div class="col-6" [hidden]="!(itemTotalOptionMap['garment'] >= 2) || !model.garment">
                <p-cascadeSelect
                  [(ngModel)]="model.rawOptionTxts[itemOptionNumber.Garment_2]"
                  [disabled]="!model.garment"
                  [options]="optionList"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['children', 'children', 'children']"
                  placeholder="Option 2"
                  [showClear]="true"
                  (onChange)="onOptionChange()"
                  (onClear)="onOptionChange()"
                ></p-cascadeSelect>
              </div>
            </div>
          </div>
          <div class="col-4" [hidden]="garmentEnchant3List.length === 0 || !model.garment">
            <p-dropdown
              inputId="garmentEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="garmentEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.garmentEnchant1"
              [showClear]="true"
              [disabled]="garmentEnchant1List.length === 0 || !model.garment"
              (onChange)="onSelectItem('garmentEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.garmentEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="garmentEnchant3List.length === 0 || !model.garment">
            <p-dropdown
              inputId="garmentEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="garmentEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.garmentEnchant2"
              [showClear]="true"
              [disabled]="garmentEnchant2List.length === 0 || !model.garment"
              (onChange)="onSelectItem('garmentEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.garmentEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="garmentEnchant3List.length === 0 || !model.garment">
            <p-dropdown
              inputId="garmentEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="garmentEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.garmentEnchant3"
              [showClear]="true"
              [disabled]="garmentEnchant3List.length === 0 || !model.garment"
              (onChange)="onSelectItem('garmentEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.garmentEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.garment">
      <div class="col-12">
        <app-equipment
          [itemType]="'garment'"
          [placeholder]="'Garment'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="garmentList"
          [refineList]="refineList"
          [cardList]="garmentCardList"
          [optionList]="optionList"
          [(itemId)]="model2.garment"
          [(itemRefine)]="model2.garmentRefine"
          [(card1Id)]="model2.garmentCard"
          [(enchant2Id)]="model2.garmentEnchant1"
          [(enchant3Id)]="model2.garmentEnchant2"
          [(enchant4Id)]="model2.garmentEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.Garment_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.Garment_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Boot -->
    <div class="grid grid-nogutter item_label_def">
      <div class="col-3">
        <div class="grid grid-nogutter justify-content-end">
          <div class="col-12">
            <p-dropdown
              inputId="boot"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="bootList"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.boot"
              [showClear]="true"
              (onChange)="onSelectItem('boot', $event.value, model.bootRefine)"
              (onClear)="onClearItem('boot')"
              placeholder="Boot"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.boot">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" style="min-width: 70px">
            <p-dropdown
              [options]="refineList"
              [(ngModel)]="model.bootRefine"
              [disabled]="!model.boot"
              (onChange)="onSelectItem('boot', model.boot, $event.value)"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1">
                  <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-9">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <p-dropdown
              inputId="bootCard"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="bootCardList"
              [filter]="true"
              filterBy="label,cardPrefix"
              [(ngModel)]="model.bootCard"
              [disabled]="!model.boot || itemSlotsMap.boot < 1"
              [showClear]="true"
              (onChange)="onSelectItem('bootCard', $event.value)"
              placeholder="Card"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.bootCard">
                  <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-8"></div>
          <div class="col-4" [hidden]="bootEnchant3List.length === 0 || !model.boot">
            <p-dropdown
              inputId="bootEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="bootEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.bootEnchant1"
              [showClear]="true"
              [disabled]="bootEnchant1List.length === 0 || !model.boot"
              (onChange)="onSelectItem('bootEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.bootEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="bootEnchant3List.length === 0 || !model.boot">
            <p-dropdown
              inputId="bootEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="bootEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.bootEnchant2"
              [showClear]="true"
              [disabled]="bootEnchant2List.length === 0 || !model.boot"
              (onChange)="onSelectItem('bootEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.bootEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-4" [hidden]="bootEnchant3List.length === 0 || !model.boot">
            <p-dropdown
              inputId="bootEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="bootEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.bootEnchant3"
              [showClear]="true"
              [disabled]="bootEnchant3List.length === 0 || !model.boot"
              (onChange)="onSelectItem('bootEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.bootEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.boot">
      <div class="col-12">
        <app-equipment
          [itemType]="'Boot'"
          [placeholder]="'boot'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="bootList"
          [refineList]="refineList"
          [cardList]="bootCardList"
          [optionList]="optionList"
          [(itemId)]="model2.boot"
          [(itemRefine)]="model2.bootRefine"
          [(card1Id)]="model2.bootCard"
          [(enchant2Id)]="model2.bootEnchant1"
          [(enchant3Id)]="model2.bootEnchant2"
          [(enchant4Id)]="model2.bootEnchant3"
          (selectItemChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Acc Right -->
    <div class="grid grid-nogutter item_label_acc">
      <div class="col-3">
        <span class="p-float-label">
          <p-dropdown
            inputId="accRight"
            [autoDisplayFirst]="false"
            [resetFilterOnHide]="true"
            [options]="accRightList"
            [filter]="true"
            filterBy="label"
            [(ngModel)]="model.accRight"
            [showClear]="true"
            (onChange)="onSelectItem('accRight', $event.value)"
            (onClear)="onClearItem('accRight')"
            placeholder="Acc R"
          >
            <ng-template let-item pTemplate="selectedItem">
              <div class="flex gap-1 item_template" *ngIf="model.accRight">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
            <ng-template let-item pTemplate="item">
              <div class="flex gap-1">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
          </p-dropdown>
          <label for="accRight" class="item_float_label font-semibold">Right</label>
        </span>
      </div>
      <div class="col-3">
        <p-dropdown
          inputId="accRightCard"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="accRightCardList"
          [filter]="true"
          filterBy="label,cardPrefix"
          [(ngModel)]="model.accRightCard"
          [disabled]="!model.accRight || itemSlotsMap.accRight < 1"
          [showClear]="true"
          (onChange)="onSelectItem('accRightCard', $event.value)"
          placeholder="Card"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.accRightCard">
              <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['accRight'] >= 1) || !model.accRight">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.A_Right_1]"
          [disabled]="!model.accRight"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 1"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['accRight'] >= 2) || !model.accRight">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.A_Right_2]"
          [disabled]="!model.accRight"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 2"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
      <div class="col-12">
        <div class="grid grid-nogutter">
          <div class="col-3"></div>
          <div class="col-3" [hidden]="accRightEnchant3List.length === 0 || !model.accRight">
            <p-dropdown
              inputId="accRightEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accRightEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accRightEnchant1"
              [showClear]="true"
              (onChange)="onSelectItem('accRightEnchant1', $event.value)"
              [disabled]="accRightEnchant1List.length === 0 || !model.accRight"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accRightEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-3" [hidden]="accRightEnchant3List.length === 0 || !model.accRight">
            <p-dropdown
              inputId="accRightEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accRightEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accRightEnchant2"
              [showClear]="true"
              (onChange)="onSelectItem('accRightEnchant2', $event.value)"
              [disabled]="accRightEnchant2List.length === 0 || !model.accRight"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accRightEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-3" [hidden]="accRightEnchant3List.length === 0 || !model.accRight">
            <p-dropdown
              inputId="accRightEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accRightEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accRightEnchant3"
              [showClear]="true"
              [disabled]="accRightEnchant3List.length === 0 || !model.accRight"
              (onChange)="onSelectItem('accRightEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accRightEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-12" [hidden]="!(accRightEnchant3List.length === 0 || !model.accRight)">
        <div style="height: 2rem"></div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.accRight">
      <div class="col-12">
        <app-equipment
          [itemType]="'accRight'"
          [placeholder]="'AccRight'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accRightList"
          [cardList]="accRightCardList"
          [optionList]="optionList"
          [(itemId)]="model2.accRight"
          [(card1Id)]="model2.accRightCard"
          [(enchant2Id)]="model2.accRightEnchant1"
          [(enchant3Id)]="model2.accRightEnchant2"
          [(enchant4Id)]="model2.accRightEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.A_Right_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.A_Right_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Acc Left -->
    <div class="grid grid-nogutter item_label_acc">
      <div class="col-3">
        <span class="p-float-label">
          <p-dropdown
            inputId="accLeft"
            [autoDisplayFirst]="false"
            [resetFilterOnHide]="true"
            [options]="accLeftList"
            [filter]="true"
            filterBy="label"
            [(ngModel)]="model.accLeft"
            [showClear]="true"
            (onChange)="onSelectItem('accLeft', $event.value)"
            (onClear)="onClearItem('accLeft')"
            placeholder="Acc Left"
          >
            <ng-template let-item pTemplate="selectedItem">
              <div class="flex gap-1 item_template" *ngIf="model.accLeft">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
            <ng-template let-item pTemplate="item">
              <div class="flex gap-1">
                <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                <div>{{ item.label }}</div>
              </div>
            </ng-template>
          </p-dropdown>
          <label for="accLeft" class="item_float_label font-semibold">Left</label>
        </span>
      </div>
      <div class="col-3">
        <p-dropdown
          inputId="accLeftCard"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="accLeftCardList"
          [filter]="true"
          filterBy="label,cardPrefix"
          [(ngModel)]="model.accLeftCard"
          [disabled]="!model.accLeft || itemSlotsMap.accLeft < 1"
          [showClear]="true"
          (onChange)="onSelectItem('accLeftCard', $event.value)"
          placeholder="Card"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.accLeftCard">
              <img src="assets/demo/images/items/card.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['accLeft'] >= 1) || !model.accLeft">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.A_Left_1]"
          [disabled]="!model.accLeft"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 1"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
      <div class="col-3" [hidden]="!(itemTotalOptionMap['accLeft'] >= 2) || !model.accLeft">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.A_Left_2]"
          [disabled]="!model.accLeft"
          [options]="optionList"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children', 'children']"
          placeholder="Option 2"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>

      <div class="col-12">
        <div class="grid grid-nogutter">
          <div class="col-3"></div>
          <div class="col-3" [hidden]="accLeftEnchant3List.length === 0 || !model.accLeft">
            <p-dropdown
              inputId="accLeftEnchant1"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accLeftEnchant1List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accLeftEnchant1"
              [showClear]="true"
              [disabled]="accLeftEnchant1List.length === 0 || !model.accLeft"
              (onChange)="onSelectItem('accLeftEnchant1', $event.value)"
              placeholder="Enchant 2"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accLeftEnchant1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-3" [hidden]="accLeftEnchant3List.length === 0 || !model.accLeft">
            <p-dropdown
              inputId="accLeftEnchant2"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accLeftEnchant2List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accLeftEnchant2"
              [showClear]="true"
              [disabled]="accLeftEnchant2List.length === 0 || !model.accLeft"
              (onChange)="onSelectItem('accLeftEnchant2', $event.value)"
              placeholder="Enchant 3"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accLeftEnchant2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
          <div class="col-3" [hidden]="accLeftEnchant3List.length === 0 || !model.accLeft">
            <p-dropdown
              inputId="accLeftEnchant3"
              [autoDisplayFirst]="false"
              [resetFilterOnHide]="true"
              [options]="accLeftEnchant3List"
              [filter]="true"
              filterBy="label"
              [(ngModel)]="model.accLeftEnchant3"
              [showClear]="true"
              [disabled]="accLeftEnchant3List.length === 0 || !model.accLeft"
              (onChange)="onSelectItem('accLeftEnchant3', $event.value)"
              placeholder="Enchant 4"
            >
              <ng-template let-item pTemplate="selectedItem">
                <div class="flex gap-1 item_template" *ngIf="model.accLeftEnchant3">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div class="flex gap-1">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div>{{ item.label }}</div>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <div class="grid grid-nogutter item_label_compare" *ngIf="showCompareItemMap.accLeft">
      <div class="col-12">
        <app-equipment
          [itemType]="'accLeft'"
          [placeholder]="'AccLeft'"
          [items]="items"
          [mapEnchant]="mapEnchant"
          [itemList]="accLeftList"
          [cardList]="accLeftCardList"
          [optionList]="optionList"
          [(itemId)]="model2.accLeft"
          [(card1Id)]="model2.accLeftCard"
          [(enchant2Id)]="model2.accLeftEnchant1"
          [(enchant3Id)]="model2.accLeftEnchant2"
          [(enchant4Id)]="model2.accLeftEnchant3"
          [(option1Value)]="model2.rawOptionTxts[itemOptionNumber.A_Left_1]"
          [(option2Value)]="model2.rawOptionTxts[itemOptionNumber.A_Left_2]"
          (selectItemChange)="onCompareItemChange()"
          (optionChange)="onCompareItemChange()"
        ></app-equipment>
      </div>
    </div>

    <!-- Pet -->
    <div class="grid grid-nogutter py-3 item_label_pet">
      <div class="col-3">
        <p-dropdown
          inputId="pet"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="petList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.pet"
          [showClear]="true"
          (onChange)="onSelectItem('pet', $event.value)"
          placeholder="Pet"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.pet">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>

    <!-- Costume Upper / Shadow Weapon -->
    <div class="grid grid-nogutter">
      <div class="col-3 item_label_costume">
        <p-dropdown
          inputId="costumeEnchantUpper"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="costumeEnhUpperList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.costumeEnchantUpper"
          [showClear]="true"
          [disabled]="costumeEnhUpperList.length === 0"
          (onChange)="onSelectItem('costumeEnchantUpper', $event.value)"
          placeholder="Upper Enchant"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.costumeEnchantUpper">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 ml-4 item_label_shadow">
        <p-dropdown
          inputId="shadowWeapon"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowWeaponList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowWeapon"
          [showClear]="true"
          (onChange)="onSelectItem('shadowWeapon', $event.value)"
          (onClear)="onClearItem('shadowWeapon')"
          placeholder="Shadow Weapon"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowWeapon">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1 item_label_shadow" style="min-width: 70px">
        <p-dropdown
          inputId="shadowWeaponRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowWeaponRefine"
          [disabled]="!model.shadowWeapon"
          (onChange)="onSelectItem('shadowWeapon', model.shadowWeapon, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 item_label_shadow">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_Wp_1]"
          [disabled]="!model.shadowWeapon"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>

    <!-- Costume Middle / Shadow Armor -->
    <div class="grid grid-nogutter">
      <div class="col-3 item_label_costume">
        <p-dropdown
          inputId="costumeEnchantMiddle"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="costumeEnhMiddleList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.costumeEnchantMiddle"
          [showClear]="true"
          [disabled]="costumeEnhMiddleList.length === 0"
          (onChange)="onSelectItem('costumeEnchantMiddle', $event.value)"
          placeholder="Middle Enchant"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.costumeEnchantMiddle">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 ml-4 item_label_shadow">
        <p-dropdown
          inputId="shadowArmor"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowArmorList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowArmor"
          [showClear]="true"
          (onChange)="onSelectItem('shadowArmor', $event.value)"
          (onClear)="onClearItem('shadowArmor')"
          placeholder="Shadow Armor"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowArmor">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1 item_label_shadow" style="min-width: 70px">
        <p-dropdown
          inputId="shadowArmorRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowArmorRefine"
          [disabled]="!model.shadowArmor"
          (onChange)="onSelectItem('shadowArmor', model.shadowArmor, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 item_label_shadow">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_Ar_1]"
          [disabled]="!model.shadowArmor"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>

    <!-- Costume Lower / Shadow Shield -->
    <div class="grid grid-nogutter">
      <div class="col-3 item_label_costume">
        <p-dropdown
          inputId="costumeEnchantLower"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="costumeEnhLowerList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.costumeEnchantLower"
          [showClear]="true"
          [disabled]="costumeEnhLowerList.length === 0"
          (onChange)="onSelectItem('costumeEnchantLower', $event.value)"
          placeholder="Lower Enchant"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.costumeEnchantLower">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 ml-4 item_label_shadow">
        <p-dropdown
          inputId="shadowShield"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowShieldList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowShield"
          [showClear]="true"
          (onChange)="onSelectItem('shadowShield', $event.value)"
          (onClear)="onClearItem('shadowShield')"
          placeholder="Shadow Shield"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowShield">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1 item_label_shadow" style="min-width: 70px">
        <p-dropdown
          inputId="shadowShieldRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowShieldRefine"
          [disabled]="!model.shadowShield"
          (onChange)="onSelectItem('shadowShield', model.shadowShield, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 item_label_shadow">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_Sh_1]"
          [disabled]="!model.shadowShield"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>

    <!-- Costume Garment / Shadow Boot -->
    <div class="grid grid-nogutter">
      <div class="col-3 item_label_costume">
        <p-dropdown
          inputId="costumeEnchantGarment"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="costumeEnhGarmentList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.costumeEnchantGarment"
          [showClear]="true"
          [disabled]="costumeEnhGarmentList.length === 0"
          (onChange)="onSelectItem('costumeEnchantGarment', $event.value)"
          placeholder="Garment Enchant"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.costumeEnchantGarment">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 ml-4 item_label_shadow">
        <p-dropdown
          inputId="shadowBoot"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowBootList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowBoot"
          [showClear]="true"
          (onChange)="onSelectItem('shadowBoot', $event.value)"
          (onClear)="onClearItem('shadowBoot')"
          placeholder="Shadow Boot"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowBoot">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1 item_label_shadow" style="min-width: 70px">
        <p-dropdown
          inputId="shadowBootRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowBootRefine"
          [disabled]="!model.shadowBoot"
          (onChange)="onSelectItem('shadowBoot', model.shadowBoot, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 item_label_shadow">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_B_1]"
          [disabled]="!model.shadowBoot"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>

    <!-- Shadow Earring -->
    <div class="grid grid-nogutter">
      <div class="col-3 item_label_costume">
        <p-dropdown
          inputId="costumeEnchantGarment4"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="costumeEnhGarment4List"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.costumeEnchantGarment4"
          [showClear]="true"
          [disabled]="costumeEnhGarment4List.length === 0"
          (onChange)="onSelectItem('costumeEnchantGarment4', $event.value)"
          placeholder="Garment Enchant 4th"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.costumeEnchantGarment4">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 ml-4 item_label_shadow">
        <p-dropdown
          inputId="shadowEarring"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowEarringList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowEarring"
          [showClear]="true"
          (onChange)="onSelectItem('shadowEarring', $event.value)"
          (onClear)="onClearItem('shadowEarring')"
          placeholder="Shadow Earring"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowEarring">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1 item_label_shadow" style="min-width: 70px">
        <p-dropdown
          inputId="shadowEarringRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowEarringRefine"
          [disabled]="!model.shadowEarring"
          (onChange)="onSelectItem('shadowEarring', model.shadowEarring, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3 item_label_shadow">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_Ear_1]"
          [disabled]="!model.shadowEarring"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>

    <!-- Shadow Pendant -->
    <div class="grid grid-nogutter item_label_shadow">
      <div class="col-3"></div>
      <div class="col-3 ml-4">
        <p-dropdown
          inputId="shadowPendant"
          [autoDisplayFirst]="false"
          [resetFilterOnHide]="true"
          [options]="shadowPendantList"
          [filter]="true"
          filterBy="label"
          [(ngModel)]="model.shadowPendant"
          [showClear]="true"
          (onChange)="onSelectItem('shadowPendant', $event.value)"
          (onClear)="onClearItem('shadowPendant')"
          placeholder="Shadow Pendant"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1 item_template" *ngIf="model.shadowPendant">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" class="item_img" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
          <ng-template let-item pTemplate="item">
            <div class="flex gap-1">
              <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
              <div>{{ item.label }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-1" style="min-width: 70px">
        <p-dropdown
          inputId="shadowPendantRefine"
          [options]="shadowRefineList"
          [(ngModel)]="model.shadowPendantRefine"
          [disabled]="!model.shadowPendant"
          (onChange)="onSelectItem('shadowPendant', model.shadowPendant, $event.value)"
        >
          <ng-template let-item pTemplate="selectedItem">
            <div class="flex gap-1">
              <div>{{ item.label > 0 ? '+ ' : '' }} {{ item.label || 0 }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="col-3">
        <p-cascadeSelect
          [(ngModel)]="model.rawOptionTxts[itemOptionNumber.SD_Pan_1]"
          [disabled]="!model.shadowPendant"
          [options]="basicOptions"
          optionValue="value"
          optionGroupLabel="label"
          optionLabel="label"
          [optionGroupChildren]="['children', 'children']"
          placeholder="Options"
          [showClear]="true"
          (onChange)="onOptionChange()"
          (onClear)="onOptionChange()"
        ></p-cascadeSelect>
      </div>
    </div>
  </div>

  <!-- Right Side -->
  <div class="p-fluid col-5">
    <p-accordion [multiple]="true" [activeIndex]="[2, 6]">
      <p-accordionTab header="Consumables" class="consumable">
        <div class="grid grid-nogutter">
          <!-- Consumable -->
          <div class="col-4">
            <p-listbox
              [options]="consumableList"
              [(ngModel)]="model.consumables"
              [multiple]="true"
              [metaKeySelection]="false"
              (onChange)="onConsumableChange()"
            >
              <ng-template let-item pTemplate="item">
                <div class="flex gap-2">
                  <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                  <div class="text_ellips">{{ item.label }}</div>
                </div>
              </ng-template>
            </p-listbox>
          </div>

          <div class="col-4">
            <div class="grid grid-nogutter column_list">
              <div *ngFor="let con of consumableList2; let i = index" class="col-12">
                <p-listbox
                  [options]="con"
                  [(ngModel)]="model.consumables2[i]"
                  [multiple]="false"
                  [metaKeySelection]="false"
                  (onChange)="onConsumableChange()"
                >
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
            </div>
          </div>

          <div class="col-4">
            <div class="grid grid-nogutter">
              <div class="col-12">
                <p-listbox
                  [options]="aspdPotionList"
                  [(ngModel)]="model.aspdPotion"
                  [multiple]="false"
                  [metaKeySelection]="false"
                  (onChange)="onConsumableChange()"
                >
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
              <div class="col-12">
                <p-listbox
                  [options]="aspdPotionList2"
                  [(ngModel)]="model.aspdPotions"
                  [multiple]="true"
                  [metaKeySelection]="false"
                  (onChange)="onConsumableChange()"
                >
                  <ng-template let-item pTemplate="item">
                    <div class="flex gap-2">
                      <img src="assets/demo/images/items/{{ item.value }}.png" alt="" style="width: 19px" />
                      <div class="text_ellips">{{ item.label }}</div>
                    </div>
                  </ng-template>
                </p-listbox>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Skills" class="select_skill">
        <div class="grid grid-nogutter">
          <!--  Buffs -->
          <div class="col-4">
            <p-tag severity="info" value="Buffs"></p-tag>
            <div class="grid grid-nogutter">
              <div *ngFor="let bishopBuff of skillBuffs; let i = index" class="col-12">
                <div [ngSwitch]="bishopBuff.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ bishopBuff.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="bishopBuff.dropdown"
                        [(ngModel)]="model.skillBuffs[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ bishopBuff.label }}</span>
                      <p-selectButton
                        [options]="bishopBuff.dropdown"
                        [(ngModel)]="model.skillBuffs[i]"
                        (ngModelChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Learned Skills -->
          <div class="col-4" [hidden]="passiveSkills.length === 0">
            <p-tag severity="warning" value="Learn to get bonuses"></p-tag>
            <div class="grid grid-nogutter">
              <div *ngFor="let passiveSkill of passiveSkills; let i = index" class="col-12">
                <div [ngSwitch]="passiveSkill.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ passiveSkill.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="passiveSkill.dropdown"
                        [(ngModel)]="model.passiveSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ passiveSkill.label }}</span>
                      <p-selectButton
                        [options]="passiveSkill.dropdown"
                        [(ngModel)]="model.passiveSkills[i]"
                        (ngModelChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Active SKills -->
          <div class="col-4">
            <p-tag severity="danger" value="Active skills"></p-tag>
            <div class="grid grid-nogutter">
              <div *ngFor="let activeSkill of activeSkills; let i = index" class="col-12">
                <div [ngSwitch]="activeSkill.inputType">
                  <div *ngSwitchCase="'dropdown'">
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ activeSkill.label }}</span>
                      <p-dropdown
                        [autoDisplayFirst]="false"
                        [resetFilterOnHide]="true"
                        [options]="activeSkill.dropdown"
                        [(ngModel)]="model.activeSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-dropdown>
                    </div>
                  </div>
                  <div *ngSwitchDefault>
                    <div class="p-inputgroup">
                      <span class="p-inputgroup-addon text_group_ellips">{{ activeSkill.label }}</span>
                      <p-selectButton
                        [options]="activeSkill.dropdown"
                        [(ngModel)]="model.activeSkills[i]"
                        (onChange)="onSkillClassChange()"
                        styleClass="'width: 50%'"
                      ></p-selectButton>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Battle Summary">
        <div class="grid grid-nogutter battle_summary">
          <div class="col-12" [hidden]="!chanceList?.length">
            <p-fieldset legend="Has a chance" [toggleable]="true">
              <div *ngFor="let category of chanceList" class="field-checkbox my-2">
                <p-checkbox
                  name="group"
                  [value]="category.name"
                  [(ngModel)]="selectedChances"
                  [inputId]="category.name"
                  (ngModelChange)="onSelecteChance($event)"
                ></p-checkbox>
                <label class="font-semibold summary_chance" [for]="category.name">{{ category.label }}</label
                ><i class="pi pi-arrow-right px-1"></i>
                <span>{{ category.label2 }}</span>
              </div>
            </p-fieldset>
          </div>

          <!-- Monster -->
          <div class="col-5">
            <div class="grid grid-nogutter">
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon monster_hilight_label">Monster</span>
                  <p-dropdown
                    inputId="monsterOpponent"
                    [autoDisplayFirst]="false"
                    [resetFilterOnHide]="true"
                    [options]="groupMonsterList"
                    [filter]="true"
                    filterBy="label,searchVal"
                    [group]="true"
                    scrollHeight="300px"
                    [(ngModel)]="selectedMonster"
                    (onChange)="onMonsterChange()"
                  >
                    <ng-template let-group pTemplate="group">
                      <div class="flex align-items-center font-bold dropdown_monster_group_label">
                        <span>{{ group.label }}</span>
                      </div>
                    </ng-template>
                  </p-dropdown>
                  <!-- <button
                    type="button"
                    class="p-button-success"
                    pButton
                    label="Choose Monster"
                    [loading]="isInProcessingPreset"
                    (click)="onClickMonster()"
                  ></button> -->
                </div>
              </div>
              <!-- <div class="col-12">{{ selectedMonsterName }}</div> -->
              <div class="col-5 flex align-items-center justify-content-center">
                <div class="grid grid-nogutter" style="height: 100%; width: 100%">
                  <div class="col-12 flex align-items-center justify-content-center">
                    <img
                      src="https://static.divine-pride.net/images/mobs/png/{{ selectedMonster }}.png"
                      class="img_monster"
                      alt="-"
                    />
                  </div>
                </div>
              </div>
              <div class="col-7">
                <div class="grid grid-nogutter">
                  <div class="col-12">
                    HP
                    <span class="summary_monster_value px-1 font-semibold">{{
                      totalSummary?.monster?.hp | number
                    }}</span>
                  </div>
                  <div class="col-12">
                    Def
                    <span class="summary_monster_value px-1 font-semibold"
                      >{{ totalSummary?.monster?.softDef }} + {{ totalSummary?.monster?.def }}</span
                    >
                  </div>
                  <div class="col-12">
                    Mdef
                    <span class="summary_monster_value px-1 font-semibold"
                      >{{ totalSummary?.monster?.softMDef }} + {{ totalSummary?.monster?.mdef }}</span
                    >
                  </div>
                  <div class="col-12">
                    Req.Hit100
                    <span class="summary_monster_value px-1 font-semibold">{{
                      totalSummary?.monster?.hitRequireFor100
                    }}</span>
                  </div>
                  <div class="col-12">
                    <span class="summary_monster_value px-1 font-bold" style="color: var(--red-500)">{{
                      totalSummary?.monster?.typeUpper
                    }}</span>
                    <span *ngIf="totalSummary?.monster?.isMvp" class="font-bold px-1">MVP</span>
                  </div>
                  <div class="col-12">
                    <span
                      class="{{
                        'property_' + totalSummary?.monster?.elementUpper
                      }} summary_monster_value px-1 font-semibold"
                      >{{ totalSummary?.monster?.elementLevelUpper }}</span
                    >
                  </div>
                  <div class="col-12">
                    <span class="summary_monster_value px-1 font-semibold" style="color: var(--yellow-300)">{{
                      totalSummary?.monster?.raceUpper
                    }}</span>
                  </div>
                  <div class="col-12">
                    <span class="summary_monster_value px-1 font-semibold" style="color: var(--cyan-300)">{{
                      totalSummary?.monster?.sizeFullUpper
                    }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Skill -->
          <div class="col-7">
            <div class="grid grid-nogutter" style="position: relative">
              <div class="col-12">
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon skill_hilight_label">Skill</span>
                  <p-dropdown
                    inputId="skill"
                    [autoDisplayFirst]="false"
                    [resetFilterOnHide]="true"
                    [options]="atkSkills"
                    [(ngModel)]="model.selectedAtkSkill"
                    (onChange)="onAtkSkillChange()"
                  ></p-dropdown>
                </div>
                <!-- <span class="skill_hilight_label">Skill</span>
                <p-cascadeSelect
                  [(ngModel)]="model.selectedAtkSkill"
                  [options]="atkSkillCascades"
                  optionValue="value"
                  optionGroupLabel="label"
                  optionLabel="label"
                  [optionGroupChildren]="['levelList']"
                  (onChange)="onAtkSkillChange()"
                ></p-cascadeSelect> -->
              </div>
              <div class="col-12">
                <div class="grid grid-nogutter">
                  <div class="loading_block" *ngIf="isCalculating">
                    <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
                  </div>
                  <div class="col-6">
                    Type <span class="summary_highlight font-semibold">{{ totalSummary?.calcSkill?.dmgType }}</span>
                  </div>
                  <div class="col-6">
                    Element:
                    <span class="{{ 'property_' + totalSummary?.calcSkill?.propertySkill }} px-1 font-semibold">{{
                      totalSummary?.calcSkill?.propertySkill
                    }}</span
                    ><span class="summary_highlight px-2">( x {{ totalSummary?.dmg?.skillPropertyMultiplier }})</span>
                  </div>
                  <div class="col-6">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="BaseSkill:"
                      unit="%"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.calcSkill?.baseSkillDamage"
                      [max2]="totalSummary2?.calcSkill?.baseSkillDamage"
                    ></app-calc-value>
                  </div>
                  <div class="col-6">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="SizePenalty:"
                      unit=" %"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.dmg?.skillSizePenalty"
                      [max2]="totalSummary2?.dmg?.skillSizePenalty"
                    ></app-calc-value>
                  </div>
                  <div class="col-6">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label=":"
                      unit="%"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.dmg?.skillTotalPene"
                      [max2]="totalSummary2?.dmg?.skillTotalPene"
                    ></app-calc-value>
                  </div>
                  <div class="col-6">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label=":"
                      unit="%"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.dmg?.skillAccuracy"
                      [max2]="totalSummary2?.dmg?.skillAccuracy"
                    ></app-calc-value>
                  </div>
                  <div class="col-6">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="ASPD:"
                      unit=" Hits/s"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.calc?.hitPerSecs"
                      [max2]="totalSummary2?.calc?.hitPerSecs"
                    ></app-calc-value>
                  </div>

                  <div class="col-12 py-1 divider">
                    <p-divider></p-divider>
                  </div>

                  <!-- Skill Summary -->
                  <div class="col-12">
                    <div class="grid grid-nogutter">
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="VCT:"
                          styleClass="summary_value"
                          styleClass2="summary_compare"
                          [isGreaterIsBetter]="false"
                          [max]="totalSummary?.calcSkill?.reducedVct"
                          [max2]="totalSummary2?.calcSkill?.reducedVct"
                        ></app-calc-value>
                      </div>
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="FCT:"
                          styleClass="summary_value"
                          styleClass2="summary_compare"
                          [isGreaterIsBetter]="false"
                          [max]="totalSummary?.calcSkill?.reducedFct"
                          [max2]="totalSummary2?.calcSkill?.reducedFct"
                        ></app-calc-value>
                      </div>
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="CD:"
                          styleClass="summary_value"
                          styleClass2="summary_compare"
                          [isGreaterIsBetter]="false"
                          [max]="totalSummary?.calcSkill?.reducedCd"
                          [max2]="totalSummary2?.calcSkill?.reducedCd"
                        ></app-calc-value>
                      </div>
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="Delay:"
                          styleClass="summary_value"
                          styleClass2="summary_compare"
                          [isGreaterIsBetter]="false"
                          [max]="totalSummary?.calcSkill?.reducedAcd"
                          [max2]="totalSummary2?.calcSkill?.reducedAcd"
                        ></app-calc-value>
                      </div>
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="Cast:"
                          styleClass="summary_damage"
                          styleClass2="summary_compare"
                          [isGreaterIsBetter]="false"
                          [max]="totalSummary?.calcSkill?.castPeriod"
                          [max2]="totalSummary2?.calcSkill?.castPeriod"
                        ></app-calc-value>
                      </div>
                      <div class="col-6">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="Skill/s:"
                          unit=" Hits/s"
                          styleClass="summary_highlight"
                          styleClass2="summary_compare"
                          [max]="totalSummary?.calcSkill?.totalHitPerSec"
                          [max2]="totalSummary2?.calcSkill?.totalHitPerSec"
                        ></app-calc-value>
                      </div>
                    </div>
                  </div>

                  <div class="col-12 py-1 divider">
                    <p-divider></p-divider>
                  </div>

                  <!-- Skill Damage -->
                  <div class="col-12" [hidden]="!totalSummary?.dmg?.skillCanCri">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="CriRate:"
                      unit="%"
                      styleClass="summary_damage"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.dmg?.skillCriRateToMonster"
                      [max2]="totalSummary2?.dmg?.skillCriRateToMonster"
                    ></app-calc-value>
                  </div>
                  <div class="col-12">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      [label]="totalSummary?.dmg?.skillCanCri ? 'SkillDmgCri:' : 'SkillDmg:'"
                      styleClass="summary_damage"
                      styleClass2="summary_compare"
                      [showPercentDiff]="true"
                      [totalHit]="totalSummary?.calcSkill?.totalHits"
                      [min]="totalSummary?.dmg?.skillMinDamage"
                      [max]="totalSummary?.dmg?.skillMaxDamage"
                      [min2]="totalSummary2?.dmg?.skillMinDamage"
                      [max2]="totalSummary2?.dmg?.skillMaxDamage"
                    ></app-calc-value>
                  </div>
                  <div class="col-12" *ngIf="totalSummary?.dmg?.skillPart2Label && totalSummary?.dmg?.skillMaxDamage2">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      [label]="totalSummary?.dmg?.skillPart2Label"
                      styleClass="summary_damage"
                      styleClass2="summary_compare"
                      [totalHit]="totalSummary?.calcSkill?.totalHits"
                      [min]="totalSummary?.dmg?.skillMinDamage2"
                      [max]="totalSummary?.dmg?.skillMaxDamage2"
                      [min2]="totalSummary2?.dmg?.skillMinDamage2"
                      [max2]="totalSummary2?.dmg?.skillMaxDamage2"
                    ></app-calc-value>
                  </div>
                  <!-- <div class="col-12" [hidden]="totalSummary?.dmg?.skillMaxDamageHE <= 0">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="HE:"
                      styleClass="summary_damage"
                      styleClass2="summary_compare"
                      [min]="totalSummary?.dmg?.skillMinDamageHE"
                      [max]="totalSummary?.dmg?.skillMaxDamageHE"
                      [min2]="totalSummary2?.dmg?.skillMinDamageHE"
                      [max2]="totalSummary2?.dmg?.skillMaxDamageHE"
                    ></app-calc-value>
                  </div> -->
                  <div class="col-12">
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="DPS:"
                      styleClass="summary_highlight"
                      styleClass2="summary_compare"
                      [showPercentDiff]="true"
                      [max]="totalSummary?.dmg?.skillDps"
                      [max2]="totalSummary2?.dmg?.skillDps"
                    ></app-calc-value>
                  </div>
                  <div
                    class="col-12"
                    [hidden]="totalSummary?.dmg?.effectedSkillDamageMin <= 0 || !selectedChances?.length"
                  >
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="Triggered:"
                      styleClass="summary_chance"
                      styleClass2="summary_compare"
                      [min]="totalSummary?.dmg?.effectedSkillDamageMin"
                      [max]="totalSummary?.dmg?.effectedSkillDamageMax"
                      [min2]="totalSummary2?.dmg?.effectedSkillDamageMin"
                      [max2]="totalSummary2?.dmg?.effectedSkillDamageMax"
                    ></app-calc-value>
                  </div>
                  <div
                    class="col-12"
                    [hidden]="totalSummary?.dmg?.effectedSkillDamageMin <= 0 || !selectedChances?.length"
                  >
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="Skill/s:"
                      styleClass="summary_chance_hilight"
                      styleClass2="summary_compare"
                      [max]="totalSummary?.dmg?.effectedSkillHitsPerSec"
                      [max2]="totalSummary2?.dmg?.effectedSkillHitsPerSec"
                    ></app-calc-value>
                  </div>
                  <div
                    class="col-12"
                    [hidden]="totalSummary?.dmg?.effectedSkillDamageMin <= 0 || !selectedChances?.length"
                  >
                    <app-calc-value
                      [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                      label="DPS:"
                      styleClass="summary_chance_hilight"
                      styleClass2="summary_compare"
                      [showPercentDiff]="true"
                      [max]="totalSummary?.dmg?.effectedSkillDps"
                      [max2]="totalSummary2?.dmg?.effectedSkillDps"
                    ></app-calc-value>
                  </div>

                  <div class="col-12 py-1 divider">
                    <p-divider></p-divider>
                  </div>

                  <!-- Basic Damage -->
                  <div class="col-12" [hidden]="hideBasicAtk">
                    <div class="grid grid-nogutter">
                      <div class="col-12">
                        Element:
                        <span class="{{ 'property_' + totalSummary?.propertyAtk }} px-1 font-semibold">{{
                          totalSummary?.propertyAtk
                        }}</span
                        ><span class="summary_highlight px-2">( x {{ totalSummary?.dmg?.propertyMultiplier }})</span>
                        <span
                          class="summary_monster_value px-1 font-bold"
                          style="color: var(--red-500)"
                          [hidden]="!showLeftWeapon || !model.leftWeapon"
                          >*** Atk </span
                        >
                      </div>
                      <div class="col-6" [hidden]="totalSummary?.dmg?.totalPene === totalSummary?.dmg?.skillTotalPene">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label=":"
                          unit="%"
                          styleClass="summary_highlight"
                          styleClass2="summary_compare"
                          [max]="totalSummary?.dmg?.totalPene"
                          [max2]="totalSummary2?.dmg?.totalPene"
                        ></app-calc-value>
                      </div>
                      <div class="col-6" [hidden]="totalSummary?.dmg?.accuracy === totalSummary?.dmg?.skillAccuracy">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label=":"
                          unit="%"
                          styleClass="summary_highlight"
                          styleClass2="summary_compare"
                          [max]="totalSummary?.dmg?.accuracy"
                          [max2]="totalSummary2?.dmg?.accuracy"
                        ></app-calc-value>
                      </div>
                      <div class="col-12">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="Basic:"
                          styleClass="summary_damage"
                          styleClass2="summary_compare"
                          [min]="totalSummary?.dmg?.basicMinDamage"
                          [max]="totalSummary?.dmg?.basicMaxDamage"
                          [min2]="totalSummary2?.dmg?.basicMinDamage"
                          [max2]="totalSummary2?.dmg?.basicMaxDamage"
                        ></app-calc-value>
                      </div>
                      <div class="col-12">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="CriRate:"
                          unit="%"
                          styleClass="summary_damage"
                          styleClass2="summary_compare"
                          [max]="totalSummary?.dmg?.basicCriRate"
                          [max2]="totalSummary2?.dmg?.basicCriRate"
                        ></app-calc-value>
                      </div>
                      <div class="col-12">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="DmgCri:"
                          styleClass="summary_damage"
                          styleClass2="summary_compare"
                          [min]="totalSummary?.dmg?.criMinDamage"
                          [max]="totalSummary?.dmg?.criMaxDamage"
                          [min2]="totalSummary2?.dmg?.criMinDamage"
                          [max2]="totalSummary2?.dmg?.criMaxDamage"
                        ></app-calc-value>
                      </div>
                      <div class="col-12">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="DPS:"
                          styleClass="summary_highlight"
                          styleClass2="summary_compare"
                          [showPercentDiff]="true"
                          [max]="totalSummary?.dmg?.basicDps"
                          [max2]="totalSummary2?.dmg?.basicDps"
                        ></app-calc-value>
                      </div>
                      <div
                        class="col-12"
                        [hidden]="totalSummary?.dmg?.effectedBasicDamageMin <= 0 || !selectedChances?.length"
                      >
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="Triggered DmgCri:"
                          styleClass="summary_chance"
                          styleClass2="summary_compare"
                          [min]="totalSummary?.dmg?.effectedBasicCriDamageMin"
                          [max]="totalSummary?.dmg?.effectedBasicCriDamageMax"
                          [min2]="totalSummary2?.dmg?.effectedBasicCriDamageMin"
                          [max2]="totalSummary2?.dmg?.effectedBasicCriDamageMax"
                        ></app-calc-value>
                      </div>
                      <!-- <div class="col-12" [hidden]="totalSummary?.dmg?.effectedBasicDamageMin <= 0 || !selectedChances?.length">
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="ASPD:"
                          unit="Hits/s"
                          styleClass="summary_chance"
                          styleClass2="summary_compare"
                          [max]="totalSummary?.dmg?.effectedBasicHitsPerSec"
                          [max2]="totalSummary2?.dmg?.effectedBasicHitsPerSec"
                        ></app-calc-value>
                      </div> -->
                      <div
                        class="col-12"
                        [hidden]="totalSummary?.dmg?.effectedBasicDamageMin <= 0 || !selectedChances?.length"
                      >
                        <app-calc-value
                          [enableCompare]="isEnableCompare && totalSummary2?.dmg"
                          label="DPS:"
                          styleClass="summary_chance_hilight"
                          styleClass2="summary_compare"
                          [showPercentDiff]="true"
                          [max]="totalSummary?.dmg?.effectedBasicDps"
                          [max2]="totalSummary2?.dmg?.effectedBasicDps"
                        ></app-calc-value>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Table -->
          <div class="col-12">
            <p-table
              styleClass="p-datatable-striped"
              filterValue="label"
              [columns]="selectedColumns"
              [value]="calcDamages"
              [loading]="isCalculating"
              [tableStyle]="{ 'min-width': '40rem' }"
            >
              <ng-template pTemplate="caption">
                <div class="grid grid-nogutter">
                  <div class="col-6">
                    <p-multiSelect
                      [options]="groupMonsterList"
                      [group]="true"
                      [(ngModel)]="selectedMonsterIds"
                      [filter]="true"
                      filterBy="label,searchVal"
                      [showClear]="true"
                      [showToggleAll]="false"
                      scrollHeight="300px"
                      selectedItemsLabel="{0} monsters selected"
                      placeholder="Choose Monsters"
                      [maxSelectedLabels]="2"
                      (onChange)="onMonsterListChange()"
                      (onClear)="onMonsterListChange()"
                    >
                      <ng-template let-group pTemplate="group">
                        <div class="flex align-items-center font-bold dropdown_monster_group_label">
                          <span>{{ group.label }}</span>
                        </div>
                      </ng-template>
                    </p-multiSelect>
                  </div>
                  <div class="col-6">
                    <p-multiSelect
                      [options]="cols"
                      [(ngModel)]="selectedColumns"
                      optionLabel="header"
                      selectedItemsLabel="{0} columns selected"
                      placeholder="Choose Columns"
                      [maxSelectedLabels]="5"
                      (onChange)="onSelectedColChange()"
                      (onClear)="onSelectedColChange()"
                    ></p-multiSelect>
                  </div>
                </div>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th>Name</th>
                  <th *ngFor="let col of columns">
                    {{ col.header }}
                  </th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item let-columns="columns">
                <tr>
                  <td class="{{ 'property_' + item.elementName }}">{{ item.label }}</td>
                  <td *ngFor="let col of columns" class="battle_row_{{ col.field }}">
                    {{ item[col.field] > 0 ? (item[col.field] | number) : item[col.field] }}
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Multiplier Summary">
        <app-misc-detail
          [elementTable]="elementTable"
          [raceTable]="raceTable"
          [sizeTable]="sizeTable"
          [classTable]="classTable"
          [skillMultiplierTable]="skillMultiplierTable"
        ></app-misc-detail>
      </p-accordionTab>

      <p-accordionTab header="Summary">
        <div class="grid grid-nogutter" style="overflow: auto">
          <div class="col-6 json_display">
            <pre [innerHTML]="modelSummary | prettyjson : [true, 3]"></pre>
            <pre *ngIf="isEnableCompare" [innerHTML]="model2 | prettyjson : [true, 3]"></pre>
          </div>
          <div class="col-6 json_display">
            <pre [innerHTML]="totalSummary | prettyjson : [true, 3]"></pre>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Equipments Summary">
        <div class="grid grid-nogutter">
          <div class="col-6 json_display">
            <pre [innerHTML]="itemSummary | prettyjson : [true, 3]"></pre>
          </div>
          <div class="col-6 json_display">
            <pre [innerHTML]="itemSummary2 | prettyjson : [true, 3]"></pre>
          </div>
        </div>
      </p-accordionTab>

      <p-accordionTab header="Item Descriptions">
        <div class="grid grid-nogutter">
          <div class="col-4">
            <div class="item_label_compare" *ngIf="isEnableCompare && equipCompareItems?.length">
              <p-listbox
                [options]="equipCompareItems"
                [(ngModel)]="selectedCompareItemDesc"
                [metaKeySelection]="false"
                [listStyle]="{ 'max-height': '500px' }"
                (onChange)="onSelectItemDescription(true)"
              >
                <ng-template let-item pTemplate="item">
                  <div class="flex gap-1 item_template">
                    <img src="assets/demo/images/items/{{ item.id }}.png" alt="" class="item_img" />
                    <div class="text_ellips">
                      {{ item.label }}
                    </div>
                  </div>
                </ng-template>
              </p-listbox>
            </div>
            <p-listbox
              [options]="equipItems"
              [(ngModel)]="selectedItemDesc"
              [metaKeySelection]="false"
              [listStyle]="{ 'max-height': '500px' }"
              (onChange)="onSelectItemDescription()"
            >
              <ng-template let-item pTemplate="item">
                <div
                  class="flex gap-1 item_template item_label_{{ item.value }}"
                  style="background-color: var(--border-radius)"
                >
                  <img src="assets/demo/images/items/{{ item.id }}.png" alt="" class="item_img" />
                  <div class="text_ellips">
                    {{ item.label }}
                  </div>
                </div>
              </ng-template>
            </p-listbox>
          </div>
          <div class="col-8">
            <div class="grid grid-nogutter ml-2" style="max-height: 500px; overflow: auto">
              <div class="col-12 json_display">
                ItemID: {{ itemId }}
                <pre [innerHTML]="itemBonus | prettyjson : [true, 3]"></pre>
              </div>
              <div
                class="col-12 px-2 py-2"
                style="color: #000; background-color: #fff"
                [innerHTML]="itemDescription"
              ></div>
            </div>
          </div>
        </div>
      </p-accordionTab>

      <!-- <p-accordionTab header="Possible Damages">
        <div class="grid grid-nogutter">
          <div class="col-12">
            <p-listbox
              [filter]="true"
              [options]="possiblyDamages"
              [metaKeySelection]="false"
              [listStyle]="{ 'max-height': '350px' }"
            ></p-listbox>
          </div>
        </div>
      </p-accordionTab> -->
    </p-accordion>
  </div>
</div>
